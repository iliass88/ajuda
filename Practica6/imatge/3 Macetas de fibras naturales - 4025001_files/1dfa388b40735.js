var CS_CONF={"projectId":227,"status":1,"hostnames":["manomano.es"],"crossDomainTracking":0,"consentRequired":1,"collectHtml":0,"allowSubdomains":1,"visitorCookieTimeout":34164000000,"sampleRate":100,"recordingRate":1,"replayRecordingRate":1,"validationRate":1,"jquery":false,"lastTrackingDraw":null,"trackerDomain":"c.contentsquare.net","recordingDomain":"r.contentsquare.net","ed":"l.contentsquare.net/log/web"};!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return stringifiedLZString}),__webpack_require__.d(__webpack_exports__,"a",function(){return LZString});var stringifiedLZString='var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(input){if(input==null){return""}var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=LZString.compress(input);while(i<input.length*2){if(i%2==0){chr1=input.charCodeAt(i/2)>>8;chr2=input.charCodeAt(i/2)&255;if(i/2+1<input.length){chr3=input.charCodeAt(i/2+1)>>8}else{chr3=NaN}}else{chr1=input.charCodeAt((i-1)/2)&255;if((i+1)/2<input.length){chr2=input.charCodeAt((i+1)/2)>>8;chr3=input.charCodeAt((i+1)/2)&255}else{chr2=chr3=NaN}}i+=3;enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64}else{if(isNaN(chr3)){enc4=64}}output=output+LZString._keyStr.charAt(enc1)+LZString._keyStr.charAt(enc2)+LZString._keyStr.charAt(enc3)+LZString._keyStr.charAt(enc4)}return output},decompressFromBase64:function(input){if(input==null){return""}var output="",ol=0,output_,chr1,chr2,chr3,enc1,enc2,enc3,enc4,i=0,f=LZString._f;input=input.replace(/[^A-Za-z0-9+/=]/g,"");while(i<input.length){enc1=LZString._keyStr.indexOf(input.charAt(i++));enc2=LZString._keyStr.indexOf(input.charAt(i++));enc3=LZString._keyStr.indexOf(input.charAt(i++));enc4=LZString._keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;if(ol%2==0){output_=chr1<<8;if(enc3!=64){output+=f(output_|chr2)}if(enc4!=64){output_=chr3<<8}}else{output=output+f(output_|chr1);if(enc3!=64){output_=chr2<<8}if(enc4!=64){output+=f(output_|chr3)}}ol+=3}return LZString.decompress(output)},compressToUTF16:function(input){if(input==null){return""}var output="",i,c,current,status=0,f=LZString._f;input=LZString.compress(input);for(i=0;i<input.length;i++){c=input.charCodeAt(i);switch(status++){case 0:output+=f((c>>1)+32);current=(c&1)<<14;break;case 1:output+=f((current+(c>>2))+32);current=(c&3)<<13;break;case 2:output+=f((current+(c>>3))+32);current=(c&7)<<12;break;case 3:output+=f((current+(c>>4))+32);current=(c&15)<<11;break;case 4:output+=f((current+(c>>5))+32);current=(c&31)<<10;break;case 5:output+=f((current+(c>>6))+32);current=(c&63)<<9;break;case 6:output+=f((current+(c>>7))+32);current=(c&127)<<8;break;case 7:output+=f((current+(c>>8))+32);current=(c&255)<<7;break;case 8:output+=f((current+(c>>9))+32);current=(c&511)<<6;break;case 9:output+=f((current+(c>>10))+32);current=(c&1023)<<5;break;case 10:output+=f((current+(c>>11))+32);current=(c&2047)<<4;break;case 11:output+=f((current+(c>>12))+32);current=(c&4095)<<3;break;case 12:output+=f((current+(c>>13))+32);current=(c&8191)<<2;break;case 13:output+=f((current+(c>>14))+32);current=(c&16383)<<1;break;case 14:output+=f((current+(c>>15))+32,(c&32767)+32);status=0;break}}return output+f(current+32)},decompressFromUTF16:function(input){if(input==null){return""}var output="",current,c,status=0,i=0,f=LZString._f;while(i<input.length){c=input.charCodeAt(i)-32;switch(status++){case 0:current=c<<1;break;case 1:output+=f(current|(c>>14));current=(c&16383)<<2;break;case 2:output+=f(current|(c>>13));current=(c&8191)<<3;break;case 3:output+=f(current|(c>>12));current=(c&4095)<<4;break;case 4:output+=f(current|(c>>11));current=(c&2047)<<5;break;case 5:output+=f(current|(c>>10));current=(c&1023)<<6;break;case 6:output+=f(current|(c>>9));current=(c&511)<<7;break;case 7:output+=f(current|(c>>8));current=(c&255)<<8;break;case 8:output+=f(current|(c>>7));current=(c&127)<<9;break;case 9:output+=f(current|(c>>6));current=(c&63)<<10;break;case 10:output+=f(current|(c>>5));current=(c&31)<<11;break;case 11:output+=f(current|(c>>4));current=(c&15)<<12;break;case 12:output+=f(current|(c>>3));current=(c&7)<<13;break;case 13:output+=f(current|(c>>2));current=(c&3)<<14;break;case 14:output+=f(current|(c>>1));current=(c&1)<<15;break;case 15:output+=f(current|c);status=0;break}i++}return LZString.decompress(output)},compressToUint8Array:function(uncompressed){var compressed=LZString.compress(uncompressed);var buf=new Uint8Array(compressed.length*2);for(var i=0,TotalLen=compressed.length;i<TotalLen;i++){var current_value=compressed.charCodeAt(i);buf[i*2]=current_value>>>8;buf[i*2+1]=current_value%256}return buf},decompressFromUint8Array:function(compressed){if(compressed===null||compressed===undefined){return LZString.decompress(compressed)}else{var buf=new Array(compressed.length/2);for(var i=0,TotalLen=buf.length;i<TotalLen;i++){buf[i]=compressed[i*2]*256+compressed[i*2+1]}return LZString.decompress(String.fromCharCode.apply(null,buf))}},compressToEncodedURIComponent:function(uncompressed){return LZString.compressToBase64(uncompressed).replace("=","$").replace("/","-")},decompressFromEncodedURIComponent:function(compressed){if(compressed){compressed=compressed.replace("$","=").replace("-","/")}return LZString.decompressFromBase64(compressed)},compress:function(uncompressed){if(uncompressed==null){return""}var i,value,context_dictionary={},context_dictionaryToCreate={},context_c="",context_wc="",context_w="",context_enlargeIn=2,context_dictSize=3,context_numBits=2,context_data_string="",context_data_val=0,context_data_position=0,ii,f=LZString._f;for(ii=0;ii<uncompressed.length;ii+=1){context_c=uncompressed.charAt(ii);if(!Object.prototype.hasOwnProperty.call(context_dictionary,context_c)){context_dictionary[context_c]=context_dictSize++;context_dictionaryToCreate[context_c]=true}context_wc=context_w+context_c;if(Object.prototype.hasOwnProperty.call(context_dictionary,context_wc)){context_w=context_wc}else{if(Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)){if(context_w.charCodeAt(0)<256){for(i=0;i<context_numBits;i++){context_data_val=(context_data_val<<1);if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}}value=context_w.charCodeAt(0);for(i=0;i<8;i++){context_data_val=(context_data_val<<1)|(value&1);if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}value=value>>1}}else{value=1;for(i=0;i<context_numBits;i++){context_data_val=(context_data_val<<1)|value;if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}value=0}value=context_w.charCodeAt(0);for(i=0;i<16;i++){context_data_val=(context_data_val<<1)|(value&1);if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}value=value>>1}}context_enlargeIn--;if(context_enlargeIn==0){context_enlargeIn=Math.pow(2,context_numBits);context_numBits++}delete context_dictionaryToCreate[context_w]}else{value=context_dictionary[context_w];for(i=0;i<context_numBits;i++){context_data_val=(context_data_val<<1)|(value&1);if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}value=value>>1}}context_enlargeIn--;if(context_enlargeIn==0){context_enlargeIn=Math.pow(2,context_numBits);context_numBits++}context_dictionary[context_wc]=context_dictSize++;context_w=String(context_c)}}if(context_w!==""){if(Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)){if(context_w.charCodeAt(0)<256){for(i=0;i<context_numBits;i++){context_data_val=(context_data_val<<1);if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}}value=context_w.charCodeAt(0);for(i=0;i<8;i++){context_data_val=(context_data_val<<1)|(value&1);if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}value=value>>1}}else{value=1;for(i=0;i<context_numBits;i++){context_data_val=(context_data_val<<1)|value;if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}value=0}value=context_w.charCodeAt(0);for(i=0;i<16;i++){context_data_val=(context_data_val<<1)|(value&1);if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}value=value>>1}}context_enlargeIn--;if(context_enlargeIn==0){context_enlargeIn=Math.pow(2,context_numBits);context_numBits++}delete context_dictionaryToCreate[context_w]}else{value=context_dictionary[context_w];for(i=0;i<context_numBits;i++){context_data_val=(context_data_val<<1)|(value&1);if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}value=value>>1}}context_enlargeIn--;if(context_enlargeIn==0){context_enlargeIn=Math.pow(2,context_numBits);context_numBits++}}value=2;for(i=0;i<context_numBits;i++){context_data_val=(context_data_val<<1)|(value&1);if(context_data_position==15){context_data_position=0;context_data_string+=f(context_data_val);context_data_val=0}else{context_data_position++}value=value>>1}while(true){context_data_val=(context_data_val<<1);if(context_data_position==15){context_data_string+=f(context_data_val);break}else{context_data_position++}}return context_data_string},decompress:function(compressed){if(compressed==null){return""}if(compressed==""){return null}var dictionary=[],next,enlargeIn=4,dictSize=4,numBits=3,entry="",result="",i,w,bits,resb,maxpower,power,c,f=LZString._f,data={string:compressed,val:compressed.charCodeAt(0),position:32768,index:1};for(i=0;i<3;i+=1){dictionary[i]=i}bits=0;maxpower=Math.pow(2,2);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=32768;data.val=data.string.charCodeAt(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}switch(next=bits){case 0:bits=0;maxpower=Math.pow(2,8);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=32768;data.val=data.string.charCodeAt(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}c=f(bits);break;case 1:bits=0;maxpower=Math.pow(2,16);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=32768;data.val=data.string.charCodeAt(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}c=f(bits);break;case 2:return""}dictionary[3]=c;w=result=c;while(true){if(data.index>data.string.length){return""}bits=0;maxpower=Math.pow(2,numBits);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=32768;data.val=data.string.charCodeAt(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}switch(c=bits){case 0:bits=0;maxpower=Math.pow(2,8);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=32768;data.val=data.string.charCodeAt(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}dictionary[dictSize++]=f(bits);c=dictSize-1;enlargeIn--;break;case 1:bits=0;maxpower=Math.pow(2,16);power=1;while(power!=maxpower){resb=data.val&data.position;data.position>>=1;if(data.position==0){data.position=32768;data.val=data.string.charCodeAt(data.index++)}bits|=(resb>0?1:0)*power;power<<=1}dictionary[dictSize++]=f(bits);c=dictSize-1;enlargeIn--;break;case 2:return result}if(enlargeIn==0){enlargeIn=Math.pow(2,numBits);numBits++}if(dictionary[c]){entry=dictionary[c]}else{if(c===dictSize){entry=w+w.charAt(0)}else{return null}}result+=entry;dictionary[dictSize++]=w+entry.charAt(0);enlargeIn--;w=entry;if(enlargeIn==0){enlargeIn=Math.pow(2,numBits);numBits++}}}};if(typeof module!=="undefined"&&module!=null){module.exports=LZString};',LZString=getLZString();function getLZString(){var evalExtractionVariable;return eval("var module = null;"+stringifiedLZString+";evalExtractionVariable = LZString;"),evalExtractionVariable}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return StringCompression});var _lzStringUtils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),StringCompression=function(){function StringCompression(t){this.onError=t,this.worker=this.tryCreateCompressionWorker(),this.callbacks={},this.callbackId=0}return StringCompression.prototype.isSupported=function(){return void 0!==this.worker},StringCompression.prototype.compress=function(t,e){if(this.isSupported()){var i=this.getNewCallbackId();this.callbacks[i]=e,this.worker.postMessage([t,_lzStringUtils__WEBPACK_IMPORTED_MODULE_0__.b,i])}},StringCompression.prototype.compressSync=function(t){return _lzStringUtils__WEBPACK_IMPORTED_MODULE_0__.a.compressToBase64(t)},StringCompression.prototype.tryCreateCompressionWorker=function(){try{return this.createWorker("("+this.compressionScript.toString()+")()")}catch(t){}},StringCompression.prototype.createWorker=function(t){var e=this,i=window.URL||window.webkitURL,n=window.Blob,r=window.Worker;if(i&&n&&r){var o=new window.Blob([t]),s=new r(i.createObjectURL(o));return s.onerror=function(t){return e.handleWorkerError(t)},s.onmessage=function(t){return e.handleWorkerMessage(t)},s}},StringCompression.prototype.handleWorkerError=function(t){var e="WorkerError: "+(t.message?t.message:"No message");return this.onError(e)},StringCompression.prototype.handleWorkerMessage=function(t){var e=t.data,i=e[0],n=e[1];this.callbacks[i](n),delete this.callbacks[i]},StringCompression.prototype.compressionScript=function(){self.addEventListener("message",function(message){var _a=message.data,html=_a[0],lzStringSource=_a[1],callbackId=_a[2],exports={};eval(lzStringSource+"exports.LZString = LZString;"),self.postMessage([callbackId,exports.LZString.compressToBase64(html)])})},StringCompression.prototype.getNewCallbackId=function(){return this.callbackId+=1},StringCompression}()},function(t,e,i){"use strict";i.r(e);var n={};i.r(n),i.d(n,"get",function(){return V}),i.d(n,"getRequestParameters",function(){return q});var r={};function o(t){return t.replace(/([#;&,.+*~':"!^$[\]()<=>|/%?@`{}\\ ])/g,"\\$1")}i.r(r),i.d(r,"getRequestParameters",function(){return Ke});var s="detached";function a(t){for(var e=t,i=[e];null!==e.parentNode;)e=e.parentNode,i.push(e);return function(t){return g.isValidElement(t)}(e)&&i.push(s),{ancestors:i,selectionRoot:e}}var c=1,u=9;var p="data-cs-override-id",h="data-cs-dynamic-id";function l(t,e,i){var n=function(t){return o(t.localName.toLowerCase())}(t);if(function(t,e){var i=d(t);return i&&i.match(/^[\w-]+$/)&&f(p,i,e)}(t,i)){var r=d(t);return{hasUniqueIdentifier:!0,elementSelector:n+"["+p+'="'+r+'"]'}}var a=function(t){var e=t.getAttribute("id");return e?o(e):e}(t);return function(t,e,i){return e&&!function(t){return null!==d(t)}(t)&&!function(t,e){return t.hasAttribute(h)||function(t){return t&&t.match(/\d{4}/)}(e)}(t,e)&&function(t,e){return t&&f("id",t,e)}(e,i)}(t,a,i)?{hasUniqueIdentifier:!0,elementSelector:n+"#"+a}:{hasUniqueIdentifier:!1,elementSelector:n+":eq("+function(t,e){return t===s||t.nodeType===u?0:[].slice.call(t.childNodes).filter(function(t){return t.nodeType===c&&t.localName.toLowerCase()===e.localName.toLowerCase()}).indexOf(e)}(e,t)+")"}}function d(t){return t.getAttribute(p)}function f(t,e,i){return 1===i.querySelectorAll("["+t+'="'+e+'"]').length}var g,v=11;function m(t,e){var i=t.shift();if(0===t.length)return y(i);var n=l(i,t[0],e),r=n.elementSelector;if(n.hasUniqueIdentifier)return""+y(t[t.length-1])+r;var o=m(t,e);return(o?o+">":"")+r}function y(t){if(t===s)return"|detached|";if(t.host){var e=a(t.host);return m(e.ancestors,e.selectionRoot)+"|shadow-root|"}return t.nodeType===v?"|fragment|":""}!function(t){function e(t){return!!t&&"localName"in t&&"getAttribute"in t&&"hasAttribute"in t&&"parentNode"in t}t.isValidElement=e,t.getElementPath=function(t){var i=function(t){return t&&"jquery"in t&&1===t.length?t[0]:t}(t);if(i===document)return"";if(!e(i))throw i+" is not a valid element";var n=a(i);return m(n.ancestors,n.selectionRoot)}}(g||(g={})),window.CSPathComputation=window.CSPathComputation||g;var S=function(){return{getRandomPercentage:t,randGtPercent:function(e){return t()>e},randLtPercent:e,getWindowLocation:i,getCookieDomain:function(t){return t?c():void 0},getUserAgent:function(){return navigator.userAgent},getBrowserInfo:function(t){var e=t.match(/(chrome|opera|firefox|msie|trident|AppleWebKit)\/?\s*(\d+)/i)||[];return{browser:e[1],version:e[2]}},setCookie:n,buildNewCookieString:r,deleteCookie:s,getCookie:a,getCookies:function(t){t=t||[];for(var e=[],i=0;i<t.length;i++)e.push(a(t[i]));return e},getRootDomain:c,getParameterValue:function(t){var e=this.getWindowLocation().hash.match(new RegExp(t+"=([^&]*)"));return e?e[1]:null},urlHasParameter:function(t){return this.getWindowLocation().hash.indexOf(t)>-1},addScriptToDocument:function(t){var e=document.createElement("script");e.type="text/javascript",e.src=t,document.head.appendChild(e)},getReferrer:function(){var t="";try{t=window.top.document.referrer}catch(e){if(window.parent)try{t=window.parent.document.referrer}catch(e){t=""}}""===t&&(t=document.referrer);return t},Logger:function(t,i,n,r){var o=e(0===r||r?r:10),s=5,a=0;this.logMessage=function(e,r){o&&a<s&&(!function(e,r){var o=new Image(1,1),s=Date.now(),a=(Math.random()+"").slice(2,8);o.src="https://"+n+"?d="+s+"&r="+a+"&a="+t+"&v="+i+"&l="+(r||"MESSAGE")+"&s="+encodeURIComponent(e)+"&u="+encodeURIComponent(S.getUserAgent())+"&p="+encodeURIComponent(S.getWindowLocation()),o.onload=function(){}}(e,r),a++)},this.logError=function(t,e,i){e=u(t)+(e?"\n"+e:""),this.logMessage(e,i||"ERROR")}},getErrorMessageAndStack:u,getJQueryInstance:function(){return void 0!==window.jQuery?window.jQuery:void 0!==window.$&&void 0!==window.$.fn&&void 0!==window.$.fn.jquery?window.$:null},isBrowserSupported:function(){return Date.now},isValidDomain:o};function t(){return Math.floor(1e4*Math.random())/100}function e(e){return t()<e}function i(){return window.location}function n(t,e,i,n,o,s){return document.cookie=r(t,e,i,n,o,s),!0}function r(t,e,i,n,r,s){if(n&&!(n instanceof Date)){if(isNaN(n))throw"Bad type given for expires";n=new Date(Date.now()+parseInt(n))}var a=t+"="+encodeURIComponent(e)+(n?";expires="+n.toUTCString():"")+";path="+(r||"/");return void 0!==i&&null!==i&&o(i)&&(a+=";domain="+i),a+=s?";secure":""}function o(t){return t.indexOf(".")>-1}function s(t,e){a(t)&&n(t,"",e,-1,"/")}function a(t){var e=new RegExp("(^|;)[ ]*"+t+"=([^;]*)").exec(document.cookie);return e?decodeURIComponent(e[2]):null}function c(){for(var t=i().hostname.split("."),e=t.pop(),r="_cs_"+(new Date).getTime();t.length&&null===a(r);)n(r,r,e=[t.pop(),e].join("."));return s(r,e),e}function u(t){return(t.message?t.message:t.toString())+" "+(t.stack?t.stack:t.toString())}}(),w=function(){function t(){}return t.preventConflict=function(t){window.jQuery_cs=S.getJQueryInstance(),window.jQuery_cs&&t.jquery&&window.jQuery_cs.noConflict(!0)},t}();function E(){return Math.floor(Date.now()/1e3)}function _(){}var C=34164e6;function x(t){return Math.floor(1e4*Math.random())/100<t}var b=0,R=function(){function t(t){this.trackerDomain=t.trackerDomain,this.errorDomain=t.ed,this.projectId=t.projectId,this.status=t.status,this.hostnames=t.hostnames,this.crossDomainTracking=!!t.crossDomainTracking,this.collectHtml=!!t.collectHtml,this.consentRequired=!!t.consentRequired,this.allowSubdomains=!!t.allowSubdomains,this.visitorCookieTimeout=t.visitorCookieTimeout||C,this.sampleRate=t.sampleRate,this.analysisRecordingRate=t.recordingRate,this.replayRecordingRate=t.replayRecordingRate,this.validationRate=t.validationRate,this.jquery=!!t.jquery,this.lastTrackingDraw=t.lastTrackingDraw||1,this.useHttps=!0,this.recordingDomain=t.recordingDomain,this.metricRate=void 0===t.metricRate?b:t.metricRate}return t.prototype.getTrackerUri=function(){return this.protocol()+"://"+this.trackerDomain},t.prototype.getRecordingUri=function(){return this.protocol()+"://"+this.recordingDomain},t.prototype.getErrorUri=function(){return this.protocol()+"://"+this.errorDomain},t.prototype.protocol=function(){return this.useHttps?"https":"http"},t.prototype.isProjectActive=function(){return 1===this.status},t.prototype.processOptionOverrides=function(t){var e=this;t&&t.forEach&&t.forEach(function(t){var i=t[0],n=t.slice(1);if("setOption"===i){var r=n[0],o=n[1];e.setOverridableField(r,o)}})},t.prototype.setOverridableField=function(t,e){"trackerDomain"===t&&(this.trackerDomain=e),"recordingDomain"===t&&(this.recordingDomain=e),"errorDomain"===t&&(this.errorDomain=e),"useHttps"===t&&(this.useHttps=!!e)},t.prototype.getRequestParameters=function(){return{pid:""+this.projectId}},t}(),T=window.CSFrameCommunication||function(){var t,e=window.opener||window.parent,i="tag",n={ping:function(e){"ping"===e.data&&u(e.origin)&&(t=e.origin,a(n.ping),s(n.insertMessageScript),o(r("jquery.js"),function(){window.jQuery_cs=window.jQuery.noConflict(!0),o(r("utils.js"))}))},insertMessageScript:c(function(t){var e=t.data;"string"==typeof e&&"ping"!==e&&(a(n.insertMessageScript),o(e))})};return{isActivable:function(){return window!==e&&window.addEventListener},waitForConnection:function(){s(n.ping)},listen:s,removeListener:a,secureListener:c,post:function(i){t&&e.postMessage(i,t)},isAuthorizedDomain:u};function r(t){return t+"?cb="+(new Date).getTime()}function o(e,n){var r=document.createElement("script");r.type="text/javascript",r.async=!0;var o=t.replace(/^https?:/,"");r.src=o+"/"+i+"/"+e,r.onload=n,document.getElementsByTagName("head")[0].appendChild(r)}function s(t){window.addEventListener("message",t,!1)}function a(t){window.removeEventListener("message",t,!1)}function c(e){return function(i){i.origin===t&&e(i)}}function u(t){return/^https?:\/\/.*\.content-square\.fr$/.test(t)}}();var k,P=function(){function t(){}return t.check=function(){return void 0===Object.assign||this.tryObjectAssign()},t.tryObjectAssign=function(){try{var t={},e=Object.assign(t,{a:1},{b:2,c:{d:4}}),i={a:1,b:2,c:{d:4}};return JSON.stringify(e)===JSON.stringify(i)&&JSON.stringify(t)===JSON.stringify(i)}catch(t){return!1}},t}();!function(t){t.CURRENT_DOMAIN="CURRENT_DOMAIN",t.get=function(t){return S.getCookie(t)},t.set=function(e,i,n,r){return S.setCookie(e,i,n===t.CURRENT_DOMAIN?void 0:n,r)},t.remove=function(e,i){S.deleteCookie(e,i===t.CURRENT_DOMAIN?void 0:i)},t.getRootDomain=function(){return S.getRootDomain()},t.getCookieDomain=function(e){var i=S.getCookieDomain(e);return void 0!==i?i:t.CURRENT_DOMAIN}}(k||(k={}));var I,A=function(){function t(t){this.configuration=t}return t.prototype.canTrack=function(){return this.isBrowsingContextSupported()&&this.canTrackProject()},t.prototype.canTrackProject=function(){return this.configuration.isProjectActive()&&this.matchHostnames()},t.prototype.matchHostnames=function(){return this.configuration.hostnames.some(function(t){return window.location.hostname.indexOf(t)>=0})},t.prototype.isBrowsingContextSupported=function(){return this.areCookieEnabled()&&!this.isDocPrerendered()&&this.isBrowserSupported()&&S.isBrowserSupported()&&P.check()},t.prototype.areCookieEnabled=function(){return"cookie"in document&&(document.cookie.length>0||k.set("_cs_t",1,k.CURRENT_DOMAIN)&&document.cookie.indexOf("_cs_t")>-1)},t.prototype.isDocPrerendered=function(){return"visibilityState"in document&&"prerender"===document.visibilityState},t.prototype.isBrowserSupported=function(){return"pageXOffset"in window&&"pageYOffset"in window&&"onpagehide"in window&&function(){var t="CSLocalStorageTest";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}()&&window.JSON&&window.JSON.parse&&window.JSON.stringify&&window.addEventListener&&window.removeEventListener&&window.Node&&Array.prototype.filter&&Array.prototype.forEach&&document.querySelectorAll&&Date.now&&Object.keys},t}(),O=function(){function t(t,e,i){this.configuration=t,this.request=e,this.pii=i,this.isLoggingActive=!1,this.logCount=0}return t.prototype.init=function(){var t=0===this.configuration.validationRate||this.configuration.validationRate?this.configuration.validationRate:10;this.isLoggingActive=x(t),this.request.init()},t.prototype.logMessage=function(t){var e={message:t,app:"uxa",level:"WARNING",stacktrace:this.getContext()};this.sendLog(e)},t.prototype.logError=function(t){this.tryToExecute("logError",function(){throw new Error(t)})()},t.prototype.tryToExecute=function(t,e){var i=this;return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{return e.apply(void 0,n)}catch(e){try{var o={app:"uxa",level:"ERROR",message:i.pii.anonymize((e.message||e.toString())+" function "+t),stacktrace:(e.stack||"No stacktrace")+" "+i.getContext()};i.sendLog(o)}catch(t){}}}},t.prototype.sendLog=function(t){this.isLoggingAllowed()&&(this.request.send(t),this.logCount+=1)},t.prototype.isLoggingAllowed=function(){return this.isLoggingActive&&this.logCount<5},t.prototype.setContext=function(t,e){this.visitorService=t,this.sessionService=e},t.prototype.getContext=function(){if(!this.visitorService||!this.visitorService.doesVisitorExist())return"No context";var t=this.visitorService.getVisitor(),e=this.sessionService.getSession(),i={userId:t.id,sessionNumber:t.visitsCount,pageNumber:null!==e?e.pageNumber:null};return window.JSON.stringify(i)},t}();!function(t){t.toQuery=function(t){return Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}}(I||(I={}));var N=function(){return(N=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},L=function(){function t(t,e){this.domainUri=t,this.path=e,this.beforeRequest=_,this.afterRequest=_}return t.prototype.setRequestParametersProviders=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.requestParametersProviders=t},t.prototype.before=function(t){this.beforeRequest=t},t.prototype.after=function(t){this.afterRequest=t},t.prototype.send=function(){this.beforeRequest();var t=this.retrieveParameters();this.addCacheBusting(t);var e=I.toQuery(t);this.generatePixel(e),this.afterRequest()},t.prototype.retrieveParameters=function(){return this.requestParametersProviders?this.requestParametersProviders.map(function(t){return t.getRequestParameters()}).reduce(function(t,e){return N({},t,e)}):{}},t.prototype.generatePixel=function(t){var e=new window.Image(1,1);e.onload=_,e.onerror=_,e.src=this.domainUri+(this.path?"/"+this.path:"")+"?"+t},t.prototype.addCacheBusting=function(t){t.r=(""+Math.random()).slice(2,8)},t}(),D=function(){function t(t,e){this.projectConfiguration=t,this.basicLogRequestParameter=e}return t.prototype.init=function(){this.request=new L(this.projectConfiguration.getErrorUri()),this.request.setRequestParametersProviders(this,this.basicLogRequestParameter)},t.prototype.send=function(t){this.log=t,this.request.send()},t.prototype.getRequestParameters=function(){return{a:this.log.app,l:this.log.level,m:this.log.message,s:this.log.stacktrace}},t}(),M="7.9.0";function V(){return M}function q(){return{v:M}}var U,z=function(){return(z=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},H=function(){function t(t,e){this.configuration=t,this.pii=e}return t.prototype.getRequestParameters=function(){return z({d:""+Date.now(),p:this.pii.anonymize(window.location.href),u:navigator.userAgent},this.configuration.getRequestParameters(),q())},t}(),B=function(){function t(t,e){this.configuration=t,this.pii=e}return t.prototype.create=function(){var t=new H(this.configuration,this.pii),e=new D(this.configuration,t),i=new O(this.configuration,e,this.pii);return i.init(),i},t}(),F=/[a-zA-Z0-9.+_-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+/g,j=function(){function t(){}return t.prototype.anonymize=function(t){return"string"==typeof t?t.replace(F,"CS_ANONYMIZED_EMAIL"):t},t.prototype.anonymizeFields=function(t,e){var i=this;return e.forEach(function(e){t[e]=i.anonymize(t[e])}),t},t}(),W="_cs_cvars";!function(t){function e(){return k.get(W)}function i(t,e){k.set(W,t,e)}t.get=function(){return window.JSON.parse(e())},t.set=function(t,e){i(window.JSON.stringify(t),e)},t.getRaw=e,t.setRaw=i,t.remove=function(t){k.remove(W,t)},t.isValidCustomVarString=function(t){return"string"==typeof t}}(U||(U={}));var G,Z,X=function(){function t(t,e,i,n,r){this.visitorService=t,this.sessionService=e,this.exclusionService=i,this.configuration=n,this.cookieDomain=r}return t.prototype.get=function(){return{exclusion:this.exclusionService.getAppliedTrackingDraw(),visitor:this.visitorService.getVisitor(),session:this.sessionService.getSession(),cvars:U.getRaw()}},t.prototype.apply=function(t){t&&(t.exclusion?this.exclude():this.include(t))},t.prototype.exclude=function(){this.exclusionService.exclude(this.configuration.lastTrackingDraw),this.visitorService.removeCurrentVisitor(),this.sessionService.removeCurrentSession(),U.remove(this.cookieDomain)},t.prototype.include=function(t){this.exclusionService.removeExclusion(),this.visitorService.setVisitor(t.visitor),t.session?this.sessionService.setSession(t.session):this.sessionService.removeCurrentSession(),t.cvars?U.setRaw(t.cvars,this.cookieDomain):U.remove(this.cookieDomain)},t}(),K="_cs_id",Y=".",$=/^([a-z0-9\-])+(\.[0-9]+){6}$/;!function(t){function e(t){var e=t.split(Y),i=e[0],n=e.slice(1).map(Number);return{id:i,creationTimestamp:n[0],visitsCount:n[1],hitTimestamp:n[2],lastVisitTimestamp:n[3],appliedTrackingDraw:n[4],expires:n[5]}}t.get=function(){var t=k.get(K);return t?e(t):null},t.set=function(t,e){var i=function(t){return[t.id,t.creationTimestamp,t.visitsCount,t.hitTimestamp,t.lastVisitTimestamp,t.appliedTrackingDraw,t.expires].join(Y)}(t),n=new Date(t.expires);k.set(K,i,e,n)},t.remove=function(t){k.remove(K,t)},t.fromString=e,t.isValidVisitorString=function(t){return $.test(t)}}(G||(G={})),function(t){var e={},i={};t.getCookie=function(t){var i=e[t];return i||k.get(t)},t.setCookie=function(t,n,r,o){k.set(t,n,r,o),e[t]=n,function(t,n){clearTimeout(i[t]),i[t]=setTimeout(function(){delete e[t]},n)}(t,o)},t.deleteCookie=function(t,n){k.remove(t,n),clearTimeout(i[t]),delete e[t]}}(Z||(Z={}));var J,Q="_cs_s",tt=/^\d+\.[012]$/,et=function(){function t(t){this.cookieDomain=t}return t.prototype.get=function(e){var i=this.getRawSession(e);return this.isValid(i)?t.fromString(i):null},t.prototype.getRawSession=function(t){return t?k.get(Q):Z.getCookie(Q)},t.prototype.set=function(t){Z.setCookie(Q,this.toString(t),this.cookieDomain,18e5)},t.prototype.remove=function(t){Z.deleteCookie(Q,t)},t.prototype.isValid=function(e){return null!==e&&t.isValidSessionString(e)},t.prototype.toString=function(t){return[t.pageNumber,t.recordingState].join(".")},t.fromString=function(t){var e=t.split("."),i=e[0];return{recordingState:e[1],pageNumber:parseInt(i,10)}},t.isValidSessionString=function(t){return tt.test(t)},t}();!function(t){(J||(J={})).fromRaw=function(t){return{exclusion:Number(t._cs_ex),visitor:t._cs_id?G.fromString(t._cs_id):null,session:t._cs_s?et.fromString(t._cs_s):null,cvars:t._cs_cvars}}}();var it,nt=/^[0-9]+$/,rt=function(){function t(t,e){this.location=t,this.cookieDomain=e}return t.prototype.exclude=function(t){k.set("_cs_ex",t,this.cookieDomain,2592e6)},t.prototype.removeExclusion=function(){k.remove("_cs_ex",this.cookieDomain)},t.prototype.isExcluded=function(){return this.hasExclusionCookie()||this.hasExclusionInURL()},t.prototype.hasExclusionCookie=function(){return 0!==this.getAppliedTrackingDraw()},t.prototype.getAppliedTrackingDraw=function(){return Number(k.get("_cs_ex"))},t.prototype.hasExclusionInURL=function(){return this.location.href.indexOf("_cs_ex")>0},t.isValidExclusionString=function(t){return nt.test(t)},t}();!function(t){(it||(it={})).isValid=function(t){return(!t._cs_id||G.isValidVisitorString(t._cs_id))&&(!t._cs_s||et.isValidSessionString(t._cs_s))&&(!t._cs_ex||rt.isValidExclusionString(t._cs_ex))&&(!t._cs_cvars||U.isValidCustomVarString(t._cs_cvars))}}();var ot=function(){function t(t,e,i){this.xdframeOpener=t,this.logger=e,this.location=i}return t.prototype.retrieve=function(e,i){var n=this;this.callback=i,this.retrievedStates=[],this.xdframeOrigins=e.filter(function(t){return n.isNotCurrentHostname(t)}).map(t.getXdframeOrigin),this.xdframeOpener.onMessage(function(t){n.handleXdframeMessage(t)}),this.xdframeOpener.onTimeout(function(){n.handleTimeout()}),this.xdframeOpener.start(),this.xdframeOrigins.map(t.getXdframeUrl).forEach(function(t){return n.xdframeOpener.open(t)})},t.prototype.handleXdframeMessage=function(t){if(this.isXdframeMessage(t)){var e=t.data;if(!it.isValid(e))throw this.xdframeOpener.stop(),"Invalid domain state: "+JSON.stringify(t.data)+" from "+t.origin;this.retrievedStates.push(e)}this.allMessagesAreIn()&&(this.xdframeOpener.stop(),this.callback(this.retrievedStates.map(J.fromRaw)))},t.prototype.handleTimeout=function(){this.logger.logMessage("xdframe: all messages not received")},t.prototype.isXdframeMessage=function(t){return this.xdframeOrigins.indexOf(t.origin)>-1},t.prototype.allMessagesAreIn=function(){return this.retrievedStates.length===this.xdframeOrigins.length},t.prototype.isNotCurrentHostname=function(t){return!function(t,e){return-1!==t.indexOf(e,t.length-e.length)}(this.location.hostname,t)},t.getXdframeOrigin=function(t){return"https://csxd."+t},t.getXdframeUrl=function(t){return t+"/xdframe-1.html"},t}(),st=function(){function t(t){var e=this;this.logger=t,this.ALL_MESSAGES_RECEIVED_TIMEOUT=3e3,this.scopedHandleMessage=function(t){e.handleMessage(t)}}return t.prototype.onMessage=function(t){this.onMessageCallback=t},t.prototype.onTimeout=function(t){this.onTimeoutCallback=t},t.prototype.start=function(){var t=this;window.addEventListener("message",this.scopedHandleMessage),this.timeout=window.setTimeout(function(){t.onTimeoutCallback()},this.ALL_MESSAGES_RECEIVED_TIMEOUT)},t.prototype.open=function(t){var e=document.createElement("iframe");e.src=t,e.style.display="none",document.body.appendChild(e)},t.prototype.stop=function(){window.removeEventListener("message",this.scopedHandleMessage),window.clearTimeout(this.timeout),this.onMessageCallback=_,this.onTimeoutCallback=_},t.prototype.handleMessage=function(t){var e=this;this.logger.tryToExecute("XdframeMessage",function(){e.onMessageCallback(t)})()},t}();function at(t){return Array.prototype.slice.call(t)}var ct,ut=function(){return(ut=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};!function(t){t[t.WebElement=0]="WebElement",t[t.MobileView=1]="MobileView",t[t.WebViewContainer=2]="WebViewContainer"}(ct||(ct={}));var pt,ht=function(){function t(t){this.processors=t}return t.prototype.serialize=function(t,e){void 0===e&&(e={});var i=ut({},e),n=t.nodeType,r=this.processors.reduce(function(t,e){return e.beforeSerialize(t,i)},t);switch(n){case Node.ELEMENT_NODE:return this.serializeElementNode(r,i);case Node.TEXT_NODE:return this.serializeTextNode(r,i);case Node.COMMENT_NODE:return this.serializeCommentNode(r,i);case Node.DOCUMENT_TYPE_NODE:return this.serializeDoctypeNode(r,i);case Node.DOCUMENT_NODE:return this.serializeDocumentNode(r,i);default:throw new Error("serialization is not supported (nodeType: "+n+")")}},t.prototype.serializeElementNode=function(t,e){var i,n=this.processors.reduce(function(i,n){var r=n.serializeNode(t,i,e);return n.serializeElementNode(t,r,e)},{attributes:[]});return(i=n.attributes).push.apply(i,this.serializeAttributes(t,e)),n.children=this.serializeChildren(t,e),n},t.prototype.serializeAttributes=function(t,e){var i=this;return this.processors.reduce(function(i,n){return n.beforeSerializeAttributes(t,i,e)},at(t.attributes)).map(function(n){return i.serializeAttribute(t,n,e)})},t.prototype.serializeAttribute=function(t,e,i){return this.processors.reduce(function(n,r){return r.serializeAttribute(t,e,n,i)},{})},t.prototype.serializeChildren=function(t,e){var i=this;return this.processors.reduce(function(i,n){return n.beforeSerializeChildren(t,i,e)},at(t.childNodes)).map(function(t){return i.serialize(t,e)})},t.prototype.serializeTextNode=function(t,e){return this.processors.reduce(function(i,n){var r=n.serializeNode(t,i,e);return n.serializeTextNode(t,r,e)},{})},t.prototype.serializeCommentNode=function(t,e){return this.processors.reduce(function(i,n){var r=n.serializeNode(t,i,e);return n.serializeCommentNode(t,r,e)},{})},t.prototype.serializeDoctypeNode=function(t,e){return this.processors.reduce(function(i,n){var r=n.serializeNode(t,i,e);return n.serializeDoctypeNode(t,r,e)},{})},t.prototype.serializeDocumentNode=function(t,e){var i=this.processors.reduce(function(i,n){var r=n.serializeNode(t,i,e);return n.serializeDocumentNode(t,r,e)},{});return i.children=this.serializeChildren(t,e),i},t}(),lt=function(){return(lt=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},dt=function(){function t(t,e,i,n){this.domainUri=t,this.path=e,this.compressor=i,this.logger=n,this.beforeRequestCallbacks=[],this.afterRequestCallbacks=[],this.afterRequestDataRetrievedCallbacks=[]}return t.prototype.setRequestParametersProviders=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.requestParametersProviders=t},t.prototype.setRequestPayloadProvider=function(t){this.requestPayloadProvider=t},t.prototype.before=function(t){this.beforeRequestCallbacks.push(t)},t.prototype.after=function(t){this.afterRequestCallbacks.push(t)},t.prototype.afterProvidersCalled=function(t){this.afterRequestDataRetrievedCallbacks.push(t)},t.prototype.send=function(){var t=this;this.beforeRequestCallbacks.forEach(function(t){return t()});var e=this.retrieveParameters(),i=I.toQuery(e),n=this.retrievePayload();this.afterRequestDataRetrievedCallbacks.forEach(function(t){return t()}),this.compressor.compress(n,function(e){t.logger.tryToExecute("POST request",function(){t.sendXMLHttpRequest(i,e),t.afterRequestCallbacks.forEach(function(t){return t()})})()})},t.prototype.retrieveParameters=function(){return this.requestParametersProviders?this.requestParametersProviders.map(function(t){return t.getRequestParameters()}).reduce(function(t,e){return lt({},t,e)}):{}},t.prototype.retrievePayload=function(){return this.requestPayloadProvider?this.requestPayloadProvider.getRequestPayload():""},t.prototype.sendXMLHttpRequest=function(t,e){if(null!==window.XMLHttpRequest){var i=new XMLHttpRequest;i.open("POST",this.domainUri+"/"+this.path+"?"+t,!0),i.onreadystatechange=_,i.send(e)}},t}();!function(t){t[t.MUTATION_INSERT=1]="MUTATION_INSERT",t[t.MUTATION_REMOVE=2]="MUTATION_REMOVE",t[t.MUTATION_ATTRIBUTE=3]="MUTATION_ATTRIBUTE",t[t.MUTATION_CHARACTER_DATA=4]="MUTATION_CHARACTER_DATA",t[t.INITIAL_DOM=5]="INITIAL_DOM",t[t.SCROLL=6]="SCROLL",t[t.MOUSE_MOVE=7]="MOUSE_MOVE",t[t.CLICK=8]="CLICK",t[t.RESIZE=9]="RESIZE",t[t.INPUT_CHECKABLE=10]="INPUT_CHECKABLE",t[t.INPUT_SELECT=11]="INPUT_SELECT",t[t.INPUT_TEXT=12]="INPUT_TEXT",t[t.HASH_CHANGE=13]="HASH_CHANGE",t[t.CONSENT_GRANTED=14]="CONSENT_GRANTED",t[t.CONSENT_WITHDRAWN=15]="CONSENT_WITHDRAWN",t[t.MOUSE_OVER=16]="MOUSE_OVER",t[t.VISIBILITY_CHANGE=17]="VISIBILITY_CHANGE",t[t.STYLESHEET_RULE_INSERT=18]="STYLESHEET_RULE_INSERT"}(pt||(pt={}));var ft=!0;function gt(t){t.boundElement.addEventListener(t.type,t.listener,ft)}function vt(t){t.boundElement.removeEventListener(t.type,t.listener,ft)}var mt,yt=function(){function t(e,i,n,r){var o=this;this.logger=e,this.selector=i,this.nodeIdentifier=n,this.sensitiveContent=r,this.onEventCallbacks=[],this.eventHandlers=[{boundElement:document,type:"change",listener:this.selector.on(t.whiteListedCheckableInputsSelector,function(t){return o.inputCheckableListener(t.target)})},{boundElement:document,type:"change",listener:this.selector.on("select",function(t){return o.inputSelectListener(t.target)})},{boundElement:document,type:"keyup",listener:this.selector.on(t.whiteListedTextInputSelector,function(t){return o.inputTextListener(t.target)})},{boundElement:document,type:"scroll",listener:function(t){return o.scrollListener(t.target)}},{boundElement:document,type:"mousemove",listener:function(t){return o.mouseMoveListener(t)}},{boundElement:document,type:"mouseover",listener:function(t){return o.mouseOverListener(t)}},{boundElement:document,type:"click",listener:function(t){return o.clickListener(t)}}]}return t.prototype.onEvent=function(t){this.onEventCallbacks.push(function(e){e.date=Date.now(),t(e)})},t.prototype.triggerCallbacks=function(t){this.onEventCallbacks.forEach(function(e){return e(t)})},t.prototype.start=function(){this.bindHandlers(),this.triggerInitialEvents()},t.prototype.stop=function(){this.unbindHandlers()},t.prototype.bindHandlers=function(){this.eventHandlers.forEach(function(t){return gt(t)})},t.prototype.unbindHandlers=function(){this.eventHandlers.forEach(function(t){return vt(t)})},t.prototype.triggerInitialEvents=function(){this.initialTextInputListener(),this.initialScrollListener(),this.initialSelectListener(),this.initialCheckableListener()},t.prototype.initialTextInputListener=function(){for(var e=document.querySelectorAll(t.whiteListedTextInputSelector),i=0;i<e.length;i+=1){var n=e.item(i);n.value.length>0&&this.inputTextListener(n)}},t.prototype.initialScrollListener=function(){for(var t=document.getElementsByTagName("*"),e=0;e<t.length;e+=1){var i=t[e],n=this.getScrollPosition(i),r=n.top,o=n.left;0===r&&0===o||this.scrollListener(i)}},t.prototype.initialSelectListener=function(){for(var t=document.getElementsByTagName("select"),e=0;e<t.length;e+=1)this.inputSelectListener(t[e])},t.prototype.initialCheckableListener=function(){for(var e=document.querySelectorAll(t.whiteListedCheckableInputsSelector),i=0;i<e.length;i+=1)this.inputCheckableListener(e[i])},t.prototype.getScrollPosition=function(t){return t===document?{top:window.pageYOffset,left:window.pageXOffset}:{top:t.scrollTop,left:t.scrollLeft}},t.prototype.scrollListener=function(t){var e=this;this.logger.tryToExecute("scroll",function(){e.nodeIdentifier.ifIdentified(t,function(i){if(!e.sensitiveContent.isSensitiveElementNode(t)){var n=e.getScrollPosition(t);e.triggerCallbacks({type:pt.SCROLL,args:[i,n.left,n.top]})}})})()},t.prototype.mouseMoveListener=function(t){var e=this;this.logger.tryToExecute("mouseMove",function(){e.triggerCallbacks({type:pt.MOUSE_MOVE,args:[t.clientX,t.clientY]})})()},t.prototype.mouseOverListener=function(t){var e=this;this.logger.tryToExecute("mouseOver",function(){e.nodeIdentifier.ifIdentified(t.target,function(t){e.triggerCallbacks({type:pt.MOUSE_OVER,args:[t]})})})()},t.prototype.clickListener=function(t){var e=this;this.logger.tryToExecute("click",function(){e.nodeIdentifier.ifIdentified(t.target,function(t){e.triggerCallbacks({type:pt.CLICK,args:[t]})})})()},t.prototype.inputCheckableListener=function(t){var e=this;this.logger.tryToExecute("checkable",function(){e.nodeIdentifier.ifIdentified(t,function(i){e.sensitiveContent.isSensitiveElementNode(t)||e.triggerCallbacks({type:pt.INPUT_CHECKABLE,args:[i,t.checked]})})})()},t.prototype.inputSelectListener=function(t){var e=this;this.logger.tryToExecute("select",function(){e.nodeIdentifier.ifIdentified(t,function(i){e.sensitiveContent.isSensitiveElementNode(t)||e.triggerCallbacks({type:pt.INPUT_SELECT,args:[i,t.selectedIndex]})})})()},t.prototype.inputTextListener=function(t){var e=this;this.logger.tryToExecute("text",function(){e.nodeIdentifier.ifIdentified(t,function(i){e.sensitiveContent.isSensitiveElementNode(t)||e.triggerCallbacks({type:pt.INPUT_TEXT,args:[i,t.value.replace(/\S/g,"•")]})})})()},t.whiteListedTextInputSelector=["textarea","input:not([type])",'input[type="text"]','input[type="email"]','input[type="search"]','input[type="tel"]','input[type="url"]'].join(","),t.whiteListedCheckableInputsSelector=['input[type="checkbox"]','input[type="radio"]'].join(","),t}(),St=function(){function t(t,e){var i=this;this.mutationSerializer=t,this.logger=e,this.mutationObserverConfig={subtree:!0,attributes:!0,childList:!0,characterData:!0},this.mutationObserver=new MutationObserver(function(t){i.logger.tryToExecute("mutations",function(){for(var e=Date.now(),n=0;n<t.length;n+=1){var r=t[n];switch(r.date=e,r.type){case"attributes":i.attributesMutation(r);break;case"characterData":i.characterDataMutation(r);break;case"childList":i.childListMutation(r);break;default:throw new Error("mutation type is not supported")}}})()})}return t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){this.mutationObserver.observe(document,this.mutationObserverConfig),this.recordInitialDom()},t.prototype.stop=function(){this.mutationObserver.disconnect()},t.prototype.recordInitialDom=function(){var t=this.mutationSerializer.serializeDocument(document);this.onEventCallback({args:t,date:Date.now(),type:pt.INITIAL_DOM})},t.prototype.attributesMutation=function(t){var e=this.mutationSerializer.serializeMutationAttribute(t);e&&this.onEventCallback({args:e,date:t.date,type:pt.MUTATION_ATTRIBUTE})},t.prototype.characterDataMutation=function(t){var e=this.mutationSerializer.serializeMutationCharacterData(t);e&&this.onEventCallback({args:e,date:t.date,type:pt.MUTATION_CHARACTER_DATA})},t.prototype.childListMutation=function(t){var e=this,i=this.mutationSerializer.serializeMutationChildList(t);if(i){var n=i.removedNodes,r=i.addedNodes;n.forEach(function(i){e.onEventCallback({args:i,date:t.date,type:pt.MUTATION_REMOVE})}),r.forEach(function(i){e.onEventCallback({args:i,date:t.date,type:pt.MUTATION_INSERT})})}},t}(),wt=2,Et=function(){function t(t){this.storageCharsUsed=0,this.maxStoredChars=0,this.maxStoredChars=t/wt}return t.prototype.add=function(t){this.storageCharsUsed+=JSON.stringify(t).length},t.prototype.isThresholdReached=function(){return this.storageCharsUsed>this.maxStoredChars},t.prototype.reset=function(){this.storageCharsUsed=0},t}(),_t=512e3,Ct=function(){function t(t,e,i){void 0===t&&(t=[]),void 0===e&&(e={}),void 0===i&&(i=_t),this.events=t,this.requestParameters=e,this.sizeCounter=new Et(i)}return t.prototype.addEvent=function(t){this.sizeCounter.add(t),this.events.push(t)},t.prototype.eventsCount=function(){return this.events.length},t.prototype.clearEvents=function(){this.sizeCounter.reset(),this.events=[]},t.prototype.isFull=function(){return this.sizeCounter.isThresholdReached()||this.eventsCount()>=100},t.prototype.setRequestParametersFromProvider=function(t){var e=t.getRequestParameters();for(var i in e)e.hasOwnProperty(i)&&(this.requestParameters[i]=e[i])},t.prototype.getEvents=function(){return this.events},t.prototype.getRequestPayload=function(){return JSON.stringify(this.events)},t.prototype.getRequestParameters=function(){return this.requestParameters},t}(),xt=function(){function t(){this.index=1}return t.prototype.increment=function(){this.index+=1},t.prototype.reset=function(){this.index=1},t.prototype.getRequestParameters=function(){return{ri:""+this.index}},t}(),bt=i(1),Rt=function(){function t(){}return t.prototype.emit=function(e,i){var n=t.prefix+"."+e,r=t.createEvent(n,{detail:i});document.dispatchEvent(r)},t.createEvent=function(t,e){if(void 0===e&&(e={}),"function"==typeof CustomEvent)return new CustomEvent(t,e);var i=document.createEvent("CustomEvent"),n=e.bubbles,r=void 0!==n&&n,o=e.cancelable,s=void 0!==o&&o,a=e.detail;return i.initCustomEvent(t,r,s,a),i},t.prefix="cs.tracking",t}();!function(t){var e,i=5;t.initTriesCount=function(){e=0},t.renewIfNeeded=function(){if(e>=i)throw Error("Impossible to renew session, [VISITOR] "+window.JSON.stringify(G.get()));var t=Z.getCookie(Q);null!==t&&et.isValidSessionString(t)||(e+=1,window._uxa.push(["trackPageview"]))}}(mt||(mt={}));var Tt=function(){return(Tt=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},kt=function(){function t(t,e,i,n,r,o,s,a){this.recordingRequest=t,this.recordingBatch=e,this.requestParameters=i,this.requestIndex=n,this.styleSheetRuleTracker=r,this.recordingMutationsTracker=o,this.recordingPageEventsTracker=s,this.recordingBrowserEventsTracker=a,this.eventEmitter=new Rt}return t.prototype.init=function(){this.bindRecordingRequest(),this.bindTrackers()},t.prototype.bindRecordingRequest=function(){var t=this;this.recordingRequest.setRequestPayloadProvider(this.recordingBatch),this.recordingRequest.setRequestParametersProviders(this.recordingBatch),this.recordingRequest.afterProvidersCalled(function(){t.recordingBatch.clearEvents(),t.requestIndex.increment(),t.recordingBatch.setRequestParametersFromProvider(t.requestParameters)})},t.prototype.bindTrackers=function(){var t=this,e=function(e){return t.processEvent(e)};this.styleSheetRuleTracker.onEvent(e),this.recordingMutationsTracker.onEvent(e),this.recordingBrowserEventsTracker.onEvent(e),this.recordingPageEventsTracker.onEvent(e)},t.prototype.processEvent=function(t){mt.renewIfNeeded(),this.recordingBatch.addEvent(t),this.recordingBatch.isFull()&&this.pushEvents(),this.eventEmitter.emit("recordingEvent",Tt({},t,{typeName:pt[t.type]}))},t.prototype.start=function(){this.recordingBatch.setRequestParametersFromProvider(this.requestParameters),this.styleSheetRuleTracker.start(),this.recordingMutationsTracker.start(),this.recordingBrowserEventsTracker.start(),this.recordingPageEventsTracker.start(),this.eventEmitter.emit("replayRecordingStarted")},t.prototype.stop=function(){this.styleSheetRuleTracker.stop(),this.recordingMutationsTracker.stop(),this.recordingBrowserEventsTracker.stop(),this.recordingPageEventsTracker.stop()},t.prototype.clearStates=function(){this.pushEvents(),this.requestIndex.reset(),this.recordingBatch.setRequestParametersFromProvider(this.requestParameters)},t.prototype.pushEvents=function(){this.recordingBatch.eventsCount()>0&&this.recordingRequest.send()},t.prototype.triggerInitialEvents=function(){this.recordingMutationsTracker.recordInitialDom(),this.recordingPageEventsTracker.triggerInitialEvents(),this.recordingBrowserEventsTracker.triggerInitialEvents()},t.prototype.triggerConsentGranted=function(){this.recordingBatch.addEvent({date:Date.now(),type:pt.CONSENT_GRANTED})},t.prototype.triggerConsentWithdrawn=function(){this.recordingBatch.addEvent({date:Date.now(),type:pt.CONSENT_WITHDRAWN})},t}(),Pt=function(){function t(t,e,i){var n=this;this.recordingRecoveryRequest=t,this.recordingBatch=e,this.recoveryStorage=i,this.pageChangeHandler=function(){try{n.recoveryStorage.save({events:n.recordingBatch.getEvents(),metadata:n.recordingBatch.getRequestParameters()})}catch(t){}}}return t.prototype.start=function(){this.addPageChangeListener()},t.prototype.stop=function(){this.removePageChangeListener()},t.prototype.recover=function(){this.sendPersistedRecordings()},t.prototype.sendPersistedRecordings=function(){var t=this.recoveryStorage.recover();if(null!==t){var e=t,i=e.metadata,n=e.events,r=new Ct(n,i);this.recordingRecoveryRequest.setRequestPayloadProvider(r),this.recordingRecoveryRequest.setRequestParametersProviders(r),this.recordingRecoveryRequest.send()}},t.prototype.addPageChangeListener=function(){window.addEventListener("pagehide",this.pageChangeHandler)},t.prototype.removePageChangeListener=function(){window.removeEventListener("pagehide",this.pageChangeHandler)},t}(),It=function(){function t(t,e,i,n,r){this.consentService=t,this.domSerializer=e,this.nodeIdentifier=i,this.sensitiveContent=n,this.anonymization=r,this.resetAnonymization()}return t.prototype.serializeDocument=function(t){return[this.domSerializer.serialize(t,{forceChildrenSerialization:!0,withAnonymization:this.useAnonymization})]},t.prototype.serializeMutationCharacterData=function(t){var e=this;return this.nodeIdentifier.ifIdentified(t.target,function(i){var n=t.target.data;return[i,n=e.anonymizeTextIfNeeded(n)]})},t.prototype.anonymizeTextIfNeeded=function(t){return this.useAnonymization?this.anonymization.anonymizeText(t):t},t.prototype.serializeMutationAttribute=function(t){var e=this,i=t.target,n=t.attributeName,r=t.attributeNamespace;return this.nodeIdentifier.ifIdentified(t.target,function(o){if(!e.sensitiveContent.isSensitiveAttributeName(i,n)){var s=t.target.getAttributeNS(r,n);return s=e.anonymizeAttributeIfNeeded(n,s),[o,r,n,s]}})},t.prototype.anonymizeAttributeIfNeeded=function(t,e){return this.useAnonymization?this.anonymization.anonymizeAttributeValue(t,e):e},t.prototype.serializeMutationChildList=function(t){var e=this;return this.nodeIdentifier.ifIdentified(t.target,function(i){if(!e.sensitiveContent.isSensitiveElementNode(t.target))return{removedNodes:e.serializeRemovedNodes(t),addedNodes:e.serializeAddedNodes(t,i)}})},t.prototype.serializeRemovedNodes=function(t){for(var e=[],i=0;i<t.removedNodes.length;i+=1){var n=this.nodeIdentifier.popId(t.removedNodes[i]);n&&e.push([n])}return e},t.prototype.serializeAddedNodes=function(t,e){for(var i=[],n=t.nextSibling?this.nodeIdentifier.ifIdentified(t.nextSibling,function(t){return t}):null,r=0;r<t.addedNodes.length;r+=1){var o=t.addedNodes[r];if(!this.nodeIdentifier.hasIdentifier(o)){var s=this.domSerializer.serialize(o,{withAnonymization:this.useAnonymization});i.push([e,n,s])}}return i},t.prototype.resetAnonymization=function(){this.useAnonymization=!this.consentService.isAllowedByConsent()},t}();function At(t){return t===parseInt(t,10)}function Ot(t){return"string"==typeof t||t instanceof String}function Nt(t){return void 0!==t}function Lt(t){return Nt(t)&&null!==t}function Dt(t,e,i){return At(t)&&t>=e&&t<=i}var Mt,Vt=function(){function t(t,e){this.isActive=!1,this.proxify(t,e)}return t.prototype.decorate=function(t){this.onCall=t},t.prototype.enable=function(){this.isActive=!0},t.prototype.disable=function(){this.isActive=!1},t.prototype.proxify=function(t,e){var i=t[e],n=this;t[e]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.onCall&&n.isActive?n.onCall(i,this,t):i.apply(this,t)}},t}(),qt=function(){function t(t,e){var i=this;this.nodeIdentifier=t,this.logger=e,this.canTrackRuleInsertions()&&(this.insertRuleDecorator=new Vt(window.CSSStyleSheet.prototype,"insertRule"),this.insertRuleDecorator.decorate(function(t,e,n){t.apply(e,n),i.sendInsertion(e,n)}))}return t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){this.canTrackRuleInsertions()&&this.insertRuleDecorator.enable()},t.prototype.stop=function(){this.canTrackRuleInsertions()&&this.insertRuleDecorator.disable()},t.prototype.canTrackRuleInsertions=function(){return window.CSSStyleSheet&&"function"==typeof window.CSSStyleSheet.prototype.insertRule},t.prototype.sendInsertion=function(t,e){var i=this,n=e[0],r=e[1];this.logger.tryToExecute("styleSheetRuleTracker.sendInsertion",function(){i.nodeIdentifier.ifIdentified(t.ownerNode,function(t){i.onEventCallback({date:Date.now(),type:pt.STYLESHEET_RULE_INSERT,args:Nt(r)?[t,n,r]:[t,n]})})})()},t}(),Ut=function(){function t(){}return t.prototype.beforeSerialize=function(t,e){return t},t.prototype.beforeSerializeChildren=function(t,e,i){return e},t.prototype.beforeSerializeAttributes=function(t,e,i){return e},t.prototype.serializeNode=function(t,e,i){return e},t.prototype.serializeElementNode=function(t,e,i){return e},t.prototype.serializeAttribute=function(t,e,i,n){return i},t.prototype.serializeTextNode=function(t,e,i){return e},t.prototype.serializeCommentNode=function(t,e,i){return e},t.prototype.serializeDoctypeNode=function(t,e,i){return e},t.prototype.serializeDocumentNode=function(t,e,i){return e},t}(),zt=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ht=function(t){function e(){var e=t.call(this)||this;return e.currentCsId=1,e}return zt(e,t),e.prototype.beforeSerialize=function(t,e){return e.forceChildrenSerialization&&this.popId(t),t},e.prototype.beforeSerializeChildren=function(t,e){var i=this;return e.filter(function(t){return!i.hasIdentifier(t)})},e.prototype.serializeNode=function(t,e){var i=this.currentCsId;return this.currentCsId+=1,t.__contentsquare_identifier=i,e.csId=i,e},e.prototype.ifIdentified=function(t,e){if(this.hasIdentifier(t))return e(t.__contentsquare_identifier)},e.prototype.popId=function(t){var e=t.__contentsquare_identifier;delete t.__contentsquare_identifier;for(var i=t.firstChild;null!==i;i=i.nextSibling)this.popId(i);return e},e.prototype.hasIdentifier=function(t){return"__contentsquare_identifier"in t},e}(Ut),Bt=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Bt(e,t),e.prototype.beforeSerializeChildren=function(t,e){if("style"===t.localName){var i=t,n=this.cssRules(i);this.isEmptyStyleElementWithRules(i,n)&&e.push(this.createTextNodeFromRules(n))}return e},e.prototype.cssRules=function(t){var e=t.sheet;if(e)return e.cssRules||e.rules},e.prototype.isEmptyStyleElementWithRules=function(t,e){var i=t.textContent||"";return/^\s*$/.test(i)&&void 0!==e&&0!==e.length},e.prototype.createTextNodeFromRules=function(t){var e=at(t).map(function(t){return t.cssText}).join("");return document.createTextNode(e)},e.prototype.serializeNode=function(t,e){return e.nodeType=t.nodeType,e.format=ct.WebElement,e},e.prototype.serializeElementNode=function(t,e){return e.tagName=t.tagName,e.namespaceURI=t.namespaceURI,e},e.prototype.serializeAttribute=function(t,e,i){return i.name=e.name,i.value=e.value,i.namespaceURI=null!==e.namespaceURI?e.namespaceURI:"",i},e.prototype.serializeTextNode=function(t,e){return e.data=t.data,e},e.prototype.serializeCommentNode=function(t,e){return e.data=t.data,e},e.prototype.serializeDoctypeNode=function(t,e){return e.name=t.name,e.publicId=t.publicId,e.systemId=t.systemId,e},e.prototype.serializeDocumentNode=function(t,i){return i.baseURI=e.getBaseURI(t),i},e.getBaseURI=function(t){var e=t.baseURI;if(null===e||void 0===e){var i=t.getElementsByTagName("base");e=0!==i.length?i[0].href:t.URL}return e},e}(Ut),jt=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Wt=["value","checked","src","data","alt"],Gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jt(e,t),e.prototype.beforeSerializeChildren=function(t,e){return this.isSensitiveElementNode(t)?[]:e},e.prototype.beforeSerializeAttributes=function(t,e){var i=this;return this.isSensitiveElementNode(t)&&e.push(this.createSensitiveElementDimensionsAttribute(t)),e.filter(function(e){return!i.isSensitiveAttributeName(t,e.name)})},e.prototype.isSensitiveElementNode=function(t){return t.nodeType===Node.ELEMENT_NODE&&(t.hasAttribute("data-cs-mask")||"script"===t.localName)},e.prototype.isSensitiveAttributeName=function(t,e){return this.isSensitiveElementNode(t)&&-1!==Wt.indexOf(e)||this.isSensitiveInputValue(t,e)},e.prototype.isSensitiveInputValue=function(t,e){return"INPUT"===t.tagName&&"value"===e&&"button"!==t.getAttribute("type")},e.prototype.createSensitiveElementDimensionsAttribute=function(t){var e=t.getBoundingClientRect(),i=document.createAttribute("style");return i.value="width: "+e.width+"px; height: "+e.height+"px;",i},e}(Ut),Zt=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Xt=["id","class","style","src","srcset","href","rel","type"],Kt=/[^\s]/g,Yt=function(t){function e(e){var i=t.call(this)||this;return i.pii=e,i}return Zt(e,t),e.prototype.beforeSerializeChildren=function(t,e,i){return"style"===t.localName&&(i.withAnonymization=!1),e},e.prototype.serializeNode=function(t,e,i){return e.anonymized=i.withAnonymization,e},e.prototype.serializeAttribute=function(t,e,i,n){i.anonymized=n.withAnonymization;var r=n.withAnonymization?this.anonymizeAttributeValue(e.name,e.value):e.value;return i.value=this.pii.anonymize(r),i},e.prototype.serializeTextNode=function(t,e,i){var n=t.data,r=i.withAnonymization?this.anonymizeText(n):n;return e.data=this.pii.anonymize(r),e},e.prototype.anonymizeAttributeValue=function(t,e){return-1===Xt.indexOf(t)?"":e},e.prototype.anonymizeText=function(t){return t.replace(Kt,"a")},e}(Ut),$t=function(){function t(t,e){this.storageName=t,this.logger=e}return t.prototype.save=function(t){localStorage.setItem(this.storageName,JSON.stringify(t))},t.prototype.clear=function(){localStorage.removeItem(this.storageName)},t.prototype.recover=function(){var t=localStorage.getItem(this.storageName);if(null===t)return null;var e=null;try{e=JSON.parse(t)}catch(e){this.logger.logError("Invalid item in localStorage.\n         (key:"+this.storageName+"; value:"+t+")")}finally{this.clear()}return e},t}(),Jt=function(){return(Jt=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Qt=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.requestParametersProviders=t}return t.prototype.getRequestParameters=function(){return this.requestParametersProviders.reduce(function(t,e){return Jt({},e.getRequestParameters(),t)},{})},t}(),te=function(){function t(t){this.asyncTaskFactory=t,this.userActive=!1,this.pendingInactivity=null}return t.prototype.start=function(){this.userActive=!0,this.createPendingInactivity()},t.prototype.stop=function(){this.userActive=!1,this.clearPendingInactivity()},t.prototype.trackActivity=function(){this.userActive||(this.onActivityResumedCallback(),this.userActive=!0),this.clearPendingInactivity(),this.createPendingInactivity()},t.prototype.createPendingInactivity=function(){var t=this;this.pendingInactivity=this.asyncTaskFactory.create("recorded user inactive",function(){t.userActive=!1,t.clearPendingInactivity(),t.onActivityStoppedCallback()},3e4)},t.prototype.clearPendingInactivity=function(){null!==this.pendingInactivity&&(this.pendingInactivity.cancel(),this.pendingInactivity=null)},t.prototype.isUserActive=function(){return this.userActive},t.prototype.onActivityStopped=function(t){this.onActivityStoppedCallback=t},t.prototype.onActivityResumed=function(t){this.onActivityResumedCallback=t},t}(),ee=function(){function t(t,e,i,n){var r=this;this.logger=t,this.taskName=e,this.task=i,this.timeout=n,this.timeoutId=setTimeout(function(){r.execute()},this.timeout)}return t.prototype.execute=function(){var t=this;this.logger.tryToExecute(this.taskName,function(){t.task()})()},t.prototype.cancel=function(){clearTimeout(this.timeoutId)},t}(),ie=function(){function t(t){this.logger=t}return t.prototype.create=function(t,e,i){return new ee(this.logger,t,e,i)},t}();!function(t){function e(){var t=[n()];return document.documentElement&&t.push(document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight),document.body&&t.push(document.body.scrollHeight,document.body.offsetHeight),Math.max.apply(Math,t)}function i(){return document.documentElement.scrollWidth}function n(){return window.innerHeight}function r(){return window.innerWidth}function o(){return screen.width}function s(){return screen.height}t.documentHeight=e,t.documentWidth=i,t.windowHeight=n,t.windowWidth=r,t.screenWidth=o,t.screenHeight=s,t.windowOffsetX=function(){return window.pageXOffset},t.windowOffsetY=function(){return window.pageYOffset},t.getRequestParameters=function(){return{dw:""+i(),dh:""+e(),ww:""+r(),wh:""+n(),sw:""+o(),sh:""+s()}}}(Mt||(Mt={}));var ne,re,oe,se=function(){function t(t,e,i){var n=this;this.logger=t,this.location=e,this.pii=i,this.eventHandlers=[{boundElement:window,type:"resize",listener:function(){return n.resizeListener()}},{boundElement:window,type:"hashchange",listener:function(){return n.hashChangeListener()}},{boundElement:document,type:"visibilitychange",listener:function(){return n.visibilityChangeListener()}}]}return t.prototype.onEvent=function(t){this.onEventCallback=function(e){e.date=Date.now(),t(e)}},t.prototype.start=function(){this.bindHandlers(),this.triggerInitialEvents()},t.prototype.stop=function(){this.unbindHandlers()},t.prototype.bindHandlers=function(){this.eventHandlers.forEach(function(t){return gt(t)})},t.prototype.unbindHandlers=function(){this.eventHandlers.forEach(function(t){return vt(t)})},t.prototype.triggerInitialEvents=function(){this.resizeListener(),this.hashChangeListener()},t.prototype.resizeListener=function(){var t=this;this.logger.tryToExecute("resize",function(){t.onEventCallback({type:pt.RESIZE,args:[Mt.windowWidth(),Mt.windowHeight()]})})()},t.prototype.hashChangeListener=function(){var t=this;this.logger.tryToExecute("hashChange",function(){t.onEventCallback({type:pt.HASH_CHANGE,args:[t.pii.anonymize(t.location.href)]})})()},t.prototype.visibilityChangeListener=function(){var t=this;this.logger.tryToExecute("visibilityChange",function(){t.onEventCallback({type:pt.VISIBILITY_CHANGE,args:[document.visibilityState]})})()},t}(),ae=function(){function t(t,e,i,n){this.recordingPageEventsTracker=t,this.recordingMutationsTracker=e,this.recordingActivityTracker=i,this.recordingRequest=n,this.recordingRequestDuringInactivityCount=0,this.isMutationTrackerStopped=!1}return t.prototype.init=function(){var t=this;this.recordingPageEventsTracker.onEvent(function(){t.recordingActivityTracker.trackActivity(),t.recordingRequestDuringInactivityCount=0}),this.recordingRequest.after(function(){t.recordingRequestDuringInactivityCount+=1}),this.recordingActivityTracker.onActivityStopped(function(){t.recordingRequestDuringInactivityCount>=2&&(t.recordingMutationsTracker.stop(),t.isMutationTrackerStopped=!0)}),this.recordingActivityTracker.onActivityResumed(function(){t.isMutationTrackerStopped&&(t.recordingMutationsTracker.start(),t.isMutationTrackerStopped=!1)})},t.prototype.start=function(){this.recordingActivityTracker.start()},t.prototype.stop=function(){this.recordingActivityTracker.stop()},t}(),ce=function(){function t(t,e,i,n,r,o,s,a,c){this.sessionService=t,this.configuration=e,this.logger=i,this.compressor=n,this.selector=r,this.consentService=o,this.basicParameters=s,this.commands=a,this.pii=c}return t.prototype.init=function(){var t=new Ft,e=new Ht,i=new Gt,n=new Yt(this.pii),r=new ht([t,e,i,n]),o=new Ct,s=new xt,a=new Qt(s,this.basicParameters),c=this.createRecordingPostRequest(this.compressor);this.mutationSerializer=new It(this.consentService,r,e,i,n);var u=new yt(this.logger,this.selector,e,i),p=new St(this.mutationSerializer,this.logger);this.recordingService=new kt(c,o,a,s,new qt(e,this.logger),p,u,new se(this.logger,window.location,this.pii)),this.recordingInactivityService=new ae(u,p,new te(new ie(this.logger)),c);var h=new $t("csPersisted",this.logger),l=this.createRecordingPostRequest(this.compressor);this.recordingRecoveryService=new Pt(l,o,h),this.recordingInactivityService.init(),this.recordingService.init()},t.prototype.onStartTracking=function(){this.recordingRecoveryService.recover(),this.sessionService.isReplayRecorded()&&(this.recordingInactivityService.start(),this.recordingService.start(),this.recordingRecoveryService.start())},t.prototype.onAfterArtificialPageView=function(){this.sessionService.isReplayRecorded()&&(this.recordingService.clearStates(),this.recordingService.triggerInitialEvents())},t.prototype.onAfterSessionRenewal=function(){this.recordingService.clearStates(),this.sessionService.isReplayRecorded()?(this.recordingInactivityService.start(),this.recordingService.start(),this.recordingRecoveryService.start()):(this.recordingInactivityService.stop(),this.recordingService.stop(),this.recordingRecoveryService.stop())},t.prototype.onOptout=function(){this.recordingInactivityService.stop(),this.recordingService.stop(),this.recordingRecoveryService.stop()},t.prototype.onConsentGranted=function(){this.mutationSerializer.resetAnonymization(),this.recordingService.triggerConsentGranted()},t.prototype.onConsentWithdrawn=function(){this.mutationSerializer.resetAnonymization(),this.recordingService.triggerConsentWithdrawn()},t.prototype.createRecordingPostRequest=function(t){return new dt(this.configuration.getRecordingUri(),"recording",t,this.logger)},t.isSupported=function(){return"MutationObserver"in window&&new bt.a(_).isSupported()&&"visibilityState"in document},t}(),ue=function(){function t(t,e){this.visitorService=t,this.sessionService=e,this.naturalPageViewSent=!1}return t.prototype.isNaturalPageViewSent=function(){return this.naturalPageViewSent},t.prototype.setNaturalPageViewSent=function(t){this.naturalPageViewSent=t},t.prototype.getTrackingContext=function(){var t=this.getSessionKey(),e=this.getPageNumber();return t&&e?{sessionKey:t,pageNumber:e}:null},t.prototype.getSessionKey=function(){if(this.visitorService.doesVisitorExist()){var t=this.visitorService.getVisitor();return t.id+"."+t.visitsCount}return null},t.prototype.getPageNumber=function(){return this.sessionService.doesSessionExist()?this.sessionService.getSession().pageNumber:null},t}(),pe=function(){function t(t){this.trackingContextService=t,this.registeredCallbacks=[]}return t.prototype.handleCommand=function(t){if(this.registerCallback(t),this.trackingContextService.isNaturalPageViewSent()){var e=this.trackingContextService.getTrackingContext();null!==e&&this.executeAsync(t,e)}},t.prototype.registerCallback=function(t){this.registeredCallbacks.push(t)},t.prototype.executeRegisteredCallbacks=function(){var t=this,e=this.trackingContextService.getTrackingContext();null!==e&&this.registeredCallbacks.map(function(i){return t.executeAsync(i,e)})},t.prototype.executeAsync=function(t,e){setTimeout(function(){t(e)})},t}(),he=function(){function t(t){this.trackingContextService=t,this.pendingCallbacks=[]}return t.prototype.handleCommand=function(t){return this.trackingContextService.isNaturalPageViewSent()?this.applyGetSessionKey(t):void this.addPendingCallback(t)},t.prototype.applyGetSessionKey=function(t){var e=this.trackingContextService.getSessionKey();return this.hasCallback(t)&&null!==e&&this.executeAsync(t.callback,e),e},t.prototype.addPendingCallback=function(t){this.hasCallback(t)&&this.pendingCallbacks.push(t.callback)},t.prototype.flushPendingCallbacks=function(){var t=this,e=this.trackingContextService.getSessionKey();null!==e&&this.pendingCallbacks.forEach(function(i){t.executeAsync(i,e)}),this.pendingCallbacks=[]},t.prototype.hasCallback=function(t){return t&&"function"==typeof t.callback},t.prototype.executeAsync=function(t,e){setTimeout(function(){t(e)})},t}(),le=function(){function t(t,e,i){this.visitorService=t,this.sessionService=e,this.commands=i}return t.prototype.init=function(){var t=this;this.trackingContextService=new ue(this.visitorService,this.sessionService),this.afterPageViewService=new pe(this.trackingContextService),this.getSessionKeyService=new he(this.trackingContextService),this.commands.register("getSessionKey",function(e){return t.getSessionKeyService.handleCommand(e)}),this.commands.register("afterPageView",function(e){t.afterPageViewService.handleCommand(e)})},t.prototype.onAfterNaturalPageView=function(){this.trackingContextService.setNaturalPageViewSent(!0),this.getSessionKeyService.flushPendingCallbacks(),this.afterPageViewService.executeRegisteredCallbacks()},t.prototype.onAfterArtificialPageView=function(){this.afterPageViewService.executeRegisteredCallbacks()},t}(),de=50,fe=255,ge=function(){function t(t,e){this.key=t.slice(0,de),this.value=Ot(e)?e.slice(0,fe):e}return t.isValid=function(t,e){return Ot(t)&&(Ot(e)||At(e))},t}(),ve=function(){function t(t,e){this.batch=t,this.pii=e}return t.prototype.trackDynamicVariable=function(t,e){ge.isValid(t,e)&&this.batch.add(new ge(this.pii.anonymize(t),this.pii.anonymize(e)))},t}(),me=function(){function t(t,e){this.logger=t,this.compressor=e,this.batch=[]}return t.prototype.add=function(t){this.batch.push(t),this.setBatchReadyCall()},t.prototype.clear=function(){this.batch=[]},t.prototype.onBatchReady=function(t){this.batchReadyCallback=t},t.prototype.getRequestParameters=function(){for(var t={},e=0,i=this.batch;e<i.length;e++){var n=i[e];t[n.key]=n.value}return{dv:this.compressor.compressSync(JSON.stringify(t))}},t.prototype.setBatchReadyCall=function(){var t=this;void 0===this.timeout&&(this.timeout=setTimeout(this.logger.tryToExecute("dynamicVariablesBatchReady",function(){t.batchReadyCallback(),t.timeout=void 0})))},t}(),ye="dvar",Se=function(){function t(t,e,i,n,r,o){this.commands=t,this.configuration=e,this.basicParameters=i,this.logger=n,this.compressor=r,this.pii=o,this.request=new L(this.configuration.getTrackerUri(),ye),this.batch=new me(this.logger,this.compressor),this.service=new ve(this.batch,this.pii)}return t.prototype.init=function(){var t=this;this.request.setRequestParametersProviders(this.basicParameters,this.batch),this.batch.onBatchReady(function(){return t.request.send()}),this.request.after(function(){return t.batch.clear()}),this.commands.register("trackDynamicVariable",function(e){var i=void 0===e?{}:e,n=i.key,r=i.value;t.service.trackDynamicVariable(n,r)})},t}(),we=function(){function t(t,e){this.id=t,this.revenue=e}return t.from=function(e){var i=new t(e.id,parseFloat(e.revenue));return isNaN(parseFloat(e.tax))||(i.tax=parseFloat(e.tax)),isNaN(parseFloat(e.shipping))||(i.shipping=parseFloat(e.shipping)),i},t}(),Ee=function(){function t(t,e,i,n){this.id=t,this.name=e,this.price=i,this.quantity=n}return t.from=function(e){if(!t.isValid(e))return null;var i=new t(e.id,e.name,parseFloat(e.price),parseInt(e.quantity,10));return Nt(e.sku)&&(i.sku=e.sku),Nt(e.category)&&(i.category=e.category),i},t.isValid=function(t){return Ot(t.id)&&Ot(t.name)&&function(t){return"number"==typeof t&&!isNaN(t)}(parseFloat(t.price))&&At(parseInt(t.quantity,10))&&(!Nt(t.sku)||Ot(t.sku))&&(!Nt(t.category)||Ot(t.category))},t}(),_e=function(){function t(t){this.pii=t,this.clear()}return t.prototype.addTransaction=function(t){var e=this.pii.anonymizeFields(t,["id"]);this.transaction=we.from(e)},t.prototype.getTransaction=function(){return this.transaction},t.prototype.addItem=function(t){var e=this.pii.anonymizeFields(t,["id","name","sku","category"]),i=Ee.from(e);null!==i&&this.transactionItems.push(i)},t.prototype.getItems=function(){return this.transactionItems},t.prototype.clear=function(){this.transaction={id:void 0,revenue:NaN},this.transactionItems=[]},t.prototype.getRequestParameters=function(){var t={id:""+this.transaction.id,revenue:""+this.transaction.revenue};return Nt(this.transaction.tax)&&(t.tax=""+this.transaction.tax),Nt(this.transaction.shipping)&&(t.shipping=""+this.transaction.shipping),t.items=window.JSON.stringify(this.transactionItems),t},t}(),Ce=function(){function t(t,e,i,n,r){this.configuration=t,this.visitorService=e,this.sessionService=i,this.commands=n,this.pii=r}return t.prototype.init=function(){var t=new L(this.configuration.getTrackerUri(),"transaction"),e=new _e(this.pii);t.setRequestParametersProviders(this.configuration,this.visitorService,this.sessionService,e,n),t.before(function(){mt.renewIfNeeded()}),t.after(function(){e.clear()}),this.commands.register("ecommerce:addTransaction",function(t){e.addTransaction(t)}),this.commands.register("ecommerce:addItem",function(t){return e.addItem(t)}),this.commands.register("ecommerce:send",function(){return t.send()})},t}(),xe=window.performance||window.msPerformance,be=function(){function t(){}return t.prototype.getRequestParameters=function(){if(this.areTimingsUnavailable())return{};var t=this.compute();return{str:t.startRender,di:t.domInteractive,dc:t.domComplete,fl:t.fullyLoaded}},t.prototype.compute=function(){var t=xe.timing;return{startRender:""+(t.domLoading-t.requestStart),domInteractive:""+(t.domInteractive-t.requestStart),domComplete:""+(t.domComplete-t.requestStart),fullyLoaded:""+(t.loadEventEnd-t.requestStart)}},t.prototype.areTimingsUnavailable=function(){return!(xe&&xe.timing&&xe.timing.loadEventEnd>0)},t}();!function(t){t[t.TAP=0]="TAP",t[t.LONG_PRESS=1]="LONG_PRESS",t[t.DRAG=2]="DRAG",t[t.FLICK=3]="FLICK"}(ne||(ne={})),function(t){t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(re||(re={})),function(t){t[t.RESIZE=0]="RESIZE",t[t.SCROLL=1]="SCROLL",t[t.MOUSEMOVE=2]="MOUSEMOVE",t[t.MOUSEDOWN=3]="MOUSEDOWN",t[t.MOUSEUP=4]="MOUSEUP",t[t.CLICK=5]="CLICK",t[t.MOUSEOVER=6]="MOUSEOVER",t[t.MOUSEOUT=7]="MOUSEOUT",t[t.FOCUSIN=11]="FOCUSIN",t[t.FOCUSOUT=12]="FOCUSOUT",t[t.TAP=14]="TAP"}(oe||(oe={}));var Re=function(){function t(t,e){var i=this;this.gestureTracker=t,this.pathComputation=e,this.gestureTracker.onEvent(function(t){return i.onTap(t)})}return t.prototype.onTap=function(t){t.type===ne.TAP&&this.onEventCallback({type:oe.TAP,target:this.pathComputation.getElementPath(t.target)})},t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){this.gestureTracker.start()},t.prototype.stop=function(){this.gestureTracker.stop()},t}(),Te=function(){function t(){}return t.prototype.compute=function(t,e){var i=this.convertPixelsToDPs(e.x)-this.convertPixelsToDPs(t.x),n=this.convertPixelsToDPs(e.y)-this.convertPixelsToDPs(t.y),r=e.time-t.time;return{duration:r,distance:this.computeGestureDistance(i,n),direction:this.computeGestureDirection(i,n),velocity:this.computeGestureVelocity(i,n,r)}},t.prototype.convertPixelsToDPs=function(t){return t/window.devicePixelRatio},t.prototype.computeGestureDistance=function(t,e){return Math.round(Math.sqrt(t*t+e*e))},t.prototype.computeGestureVelocity=function(t,e,i){var n=i/1e3,r=t/n,o=e/n;return Math.round(Math.abs(r)+Math.abs(o))},t.prototype.computeGestureDirection=function(t,e){return Math.abs(t)>Math.abs(e)?t>0?re.RIGHT:re.LEFT:e>0?re.DOWN:re.UP},t}(),ke=function(t){return null!==t.target&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target},Pe=function(){function t(){this.metricsComputer=new Te,this.reset()}return t.prototype.onGesture=function(t){this.onGestureCallback=t},t.prototype.processActionDown=function(t){this.isGestureStart(t)&&this.reset(),this.pendingInputs.push({x:t.touches[0].pageX,y:t.touches[0].pageY,time:Date.now()}),this.target=ke(t)},t.prototype.processActionMove=function(){this.hasMove=!0},t.prototype.processActionUp=function(t){this.pendingInputs.push({x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY,time:Date.now()}),this.isValidSingleTouchGesture()&&this.runDetection()},t.prototype.reset=function(){this.pendingInputs=[],this.target=null,this.hasMove=!1},t.prototype.runDetection=function(){var t=this.metricsComputer.compute(this.pendingInputs[0],this.pendingInputs[1]),e=this.hasMove?this.computeSwipeGesture(t):this.computePressGesture(t);this.onGestureCallback(e)},t.prototype.computeSwipeGesture=function(t){return{type:t.velocity<100?ne.DRAG:ne.FLICK,target:this.target,velocity:t.velocity,distance:t.distance,direction:t.direction}},t.prototype.computePressGesture=function(t){return{type:t.duration<1e3?ne.TAP:ne.LONG_PRESS,target:this.target}},t.prototype.isGestureStart=function(t){return 1===t.touches.length},t.prototype.isValidSingleTouchGesture=function(){return 2===this.pendingInputs.length},t}(),Ie=function(){function t(t){var e=this;this.logger=t,this.eventHandlers=[{boundElement:document,type:"touchstart",listener:function(t){return e.processEvent(t)}},{boundElement:document,type:"touchmove",listener:function(t){return e.processEvent(t)}},{boundElement:document,type:"touchend",listener:function(t){return e.processEvent(t)}}],this.detector=new Pe}return t.prototype.onEvent=function(t){this.detector.onGesture(t)},t.prototype.start=function(){this.canDetectGesture()&&this.eventHandlers.forEach(function(t){return gt(t)})},t.prototype.stop=function(){this.canDetectGesture()&&this.eventHandlers.forEach(function(t){return vt(t)})},t.prototype.canDetectGesture=function(){return void 0!==window.devicePixelRatio},t.prototype.processEvent=function(t){var e=this;this.logger.tryToExecute("process gesture event",function(){switch(t.type){case"touchstart":e.detector.processActionDown(t);break;case"touchmove":e.detector.processActionMove();break;case"touchend":e.detector.processActionUp(t)}})()},t.isSwipe=function(t){return t.type===ne.FLICK||t.type===ne.DRAG},t}(),Ae=function(){function t(t,e,i,n){var r=this;this.logger=t,this.sessionService=e,this.pathComputation=i,this.selector=n,this.FOCUSABLE_ELEMENTS_SELECTOR="select, select *, input, textarea",this.HOVERABLE_ELEMENTS_SELECTOR="a, a *, button, button *, select, select *, input, textarea",this.globalHandlers=[{boundElement:window,type:"resize",listener:function(){return r.resizeListener()}},{boundElement:document,type:"scroll",listener:function(){return r.scrollListener()}},{boundElement:document,type:"mousemove",listener:function(t){return r.mouseMoveListener(t)}},{boundElement:document,type:"mousedown",listener:function(t){return r.mouseDownListener(t)}},{boundElement:document,type:"mouseup",listener:function(t){return r.mouseUpListener(t)}},{boundElement:document,type:"click",listener:function(t){return r.clickListener(t)}}],this.onSelectorHandlers=[{boundElement:document,type:"mouseover",listener:this.selector.on(this.HOVERABLE_ELEMENTS_SELECTOR,function(t){return r.mouseOverListener(t)})},{boundElement:document,type:"mouseout",listener:this.selector.on(this.HOVERABLE_ELEMENTS_SELECTOR,function(t){return r.mouseOutListener(t)})},{boundElement:document,type:"focusin",listener:this.selector.on(this.FOCUSABLE_ELEMENTS_SELECTOR,function(t){return r.focusInListener(t)})},{boundElement:document,type:"focusout",listener:this.selector.on(this.FOCUSABLE_ELEMENTS_SELECTOR,function(t){return r.focusOutListener(t)})}]}return t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){this.getSupportedHandlers().forEach(function(t){return gt(t)}),this.resizeListener()},t.prototype.stop=function(){this.getSupportedHandlers().forEach(function(t){return vt(t)})},t.prototype.getSupportedHandlers=function(){return this.selector.isMatchesSelectorSupported()?this.globalHandlers.concat(this.onSelectorHandlers):(this.logger.logMessage("Element.matches is not implemented yet"),this.globalHandlers)},t.prototype.resizeListener=function(){var t=this;this.logger.tryToExecute("Event handler type: resize",function(){t.onEventCallback({type:oe.RESIZE,x:Mt.windowWidth(),y:Mt.windowHeight()})})()},t.prototype.scrollListener=function(){var t=this;this.logger.tryToExecute("Event handler type: scroll",function(){t.sessionService.isAnalysisRecorded()&&t.onEventCallback({type:oe.SCROLL,x:Mt.windowOffsetX(),y:Mt.windowOffsetY()})})()},t.prototype.mouseMoveListener=function(t){var e=this;this.logger.tryToExecute("Event handler type: mouseMove",function(){e.sessionService.isAnalysisRecorded()&&e.onEventCallback({type:oe.MOUSEMOVE,x:t.pageX,y:t.pageY})})()},t.prototype.mouseDownListener=function(t){var e=this;this.logger.tryToExecute("Event handler type: mouseDown",function(){e.onEventCallback({type:oe.MOUSEDOWN,x:t.pageX,y:t.pageY,target:e.pathComputation.getTargetPath(t)})})()},t.prototype.mouseUpListener=function(t){var e=this;this.logger.tryToExecute("Event handler type: mouseUp",function(){e.onEventCallback({type:oe.MOUSEUP,x:t.pageX,y:t.pageY,target:e.pathComputation.getTargetPath(t)})})()},t.prototype.clickListener=function(t){var e=this;this.logger.tryToExecute("Event handler type: click",function(){e.onEventCallback({type:oe.CLICK,x:t.pageX,y:t.pageY,target:e.pathComputation.getTargetPath(t)})})()},t.prototype.mouseOverListener=function(t){var e=this;this.logger.tryToExecute("Event handler type: mouseOver",function(){e.onEventCallback({type:oe.MOUSEOVER,x:t.pageX,y:t.pageY,target:e.pathComputation.getTargetPath(t)})})()},t.prototype.mouseOutListener=function(t){var e=this;this.logger.tryToExecute("Event handler type: mouseOut",function(){e.onEventCallback({type:oe.MOUSEOUT,x:t.pageX,y:t.pageY,target:e.pathComputation.getTargetPath(t)})})()},t.prototype.focusInListener=function(t){var e=this;this.logger.tryToExecute("Event handler type: focusIn",function(){e.onEventCallback({type:oe.FOCUSIN,target:e.pathComputation.getTargetPath(t)})})()},t.prototype.focusOutListener=function(t){var e=this;this.logger.tryToExecute("Event handler type: focusOut",function(){e.onEventCallback({type:oe.FOCUSOUT,target:e.pathComputation.getTargetPath(t)})})()},t}(),Oe=function(){function t(t){var e=this;this.logger=t,this.MAX_SCROLL_RATE_THRESHOLD=100,this.maxScrollRate=0,this.maxScrollRateHandler={boundElement:document,type:"scroll",listener:function(){return e.maxScrollRateListener()}}}return t.prototype.onEvent=function(t){this.onEventCallback=t},t.prototype.start=function(){gt(this.maxScrollRateHandler),this.reset()},t.prototype.stop=function(){vt(this.maxScrollRateHandler)},t.prototype.reset=function(){this.maxScrollRate=this.currentScrollRate(),this.onEventCallback(this.maxScrollRate)},t.prototype.maxScrollRateListener=function(){var t=this;this.logger.tryToExecute("MaxScrollRate handler",function(){var e=t.currentScrollRate();e>t.maxScrollRate&&(t.maxScrollRate=e,t.onEventCallback(t.maxScrollRate))})()},t.prototype.currentScrollRate=function(){var t=Mt.documentHeight(),e=Math.round(this.lastPixelLine()/t*100);return Math.min(e,this.MAX_SCROLL_RATE_THRESHOLD)},t.prototype.lastPixelLine=function(){var t=Mt.windowHeight();return Mt.windowOffsetY()+t},t.prototype.getRequestParameters=function(){return{sr:""+this.maxScrollRate}},t}(),Ne=function(){return(Ne=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Le=function(){function t(t,e,i,n,r,o,s,a){this.analysisEventsTracker=t,this.gestureTracker=e,this.maxScrollRateTracker=i,this.performanceTimingMetrics=n,this.analysisEventsBatch=r,this.analysisEventsRequest=o,this.analysisEventRequestParameters=s,this.sessionRenewer=a,this.eventEmitter=new Rt}return t.prototype.init=function(){var t=this;this.analysisEventsTracker.onEvent(function(e){return t.processEvent(e)}),this.gestureTracker.onEvent(function(e){return t.processEvent(e)}),this.maxScrollRateTracker.onEvent(function(){t.analysisEventsBatch.setRequestParametersFromProvider(t.maxScrollRateTracker)}),this.bindRequest()},t.prototype.bindRequest=function(){var t=this;this.analysisEventsRequest.setRequestParametersProviders(this.analysisEventsBatch),this.analysisEventsRequest.before(function(){t.analysisEventsBatch.setRequestParametersFromProvider(t.performanceTimingMetrics)}),this.analysisEventsRequest.after(function(){t.analysisEventsBatch.clearEvents(),t.analysisEventsBatch.setRequestParametersFromProvider(t.analysisEventRequestParameters)})},t.prototype.initStates=function(){this.analysisEventsBatch.setRequestParametersFromProvider(this.analysisEventRequestParameters),this.resetStartTime()},t.prototype.start=function(){this.analysisEventsTracker.start(),this.maxScrollRateTracker.start(),this.gestureTracker.start()},t.prototype.processEvent=function(t){this.sessionRenewer.renewIfNeeded(),this.analysisEventsBatch.addEvent(this.serializeAnalysisEvent(t)),this.analysisEventsBatch.isFull()&&this.sendEvents(),this.eventEmitter.emit("analysisEvent",Ne({},t,{typeName:oe[t.type]}))},t.prototype.serializeAnalysisEvent=function(t){var e=[t.type,this.getRelativeTime()];return"x"in t&&e.push(t.x),"y"in t&&e.push(t.y),"target"in t&&e.push(t.target),e},t.prototype.sendEvents=function(){0!==this.analysisEventsBatch.eventsCount()&&this.analysisEventsRequest.send()},t.prototype.stop=function(){this.analysisEventsTracker.stop(),this.maxScrollRateTracker.stop(),this.gestureTracker.stop(),this.analysisEventsBatch.empty()},t.prototype.clearStates=function(){this.sendEvents(),this.maxScrollRateTracker.reset()},t.prototype.resetStartTime=function(){this.startTime=Date.now()},t.prototype.getRelativeTime=function(){return Date.now()-this.startTime},t}(),De=i(0),Me=function(){return(Me=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Ve=15360,qe=function(){function t(t,e,i){void 0===e&&(e=[]),void 0===i&&(i={}),this.sessionService=t,this.events=e,this.requestParameters=i,this.sizeCounter=new Et(Ve)}return t.prototype.addEvent=function(t){this.sizeCounter.add(t),this.events.push(t)},t.prototype.setRequestParametersFromProvider=function(t){var e=t.getRequestParameters();for(var i in e)e.hasOwnProperty(i)&&(this.requestParameters[i]=e[i])},t.prototype.eventsCount=function(){return this.events.length},t.prototype.clearEvents=function(){this.sizeCounter.reset(),this.events=[]},t.prototype.empty=function(){this.clearEvents()},t.prototype.isFull=function(){return this.sizeCounter.isThresholdReached()||this.eventsCount()>=(this.sessionService.isAnalysisRecorded()?100:50)},t.prototype.getEvents=function(){return this.events},t.prototype.getMetadata=function(){return this.requestParameters},t.prototype.getRequestParameters=function(){return Me({},this.requestParameters,{e:De.a.compressToBase64(window.JSON.stringify(this.events))})},t}(),Ue=function(){function t(t,e,i,n){var r=this;this.sessionService=t,this.analysisEventsRecoveryRequest=e,this.analysisEventsBatch=i,this.recoveryStorage=n,this.pageChangeHandler=function(){try{r.recoveryStorage.save({events:r.analysisEventsBatch.getEvents(),metadata:r.analysisEventsBatch.getMetadata()})}catch(t){}}}return t.prototype.start=function(){this.sendPersistedRecordings(),this.addPageChangeListener()},t.prototype.stop=function(){this.removePageChangeListener()},t.prototype.sendPersistedRecordings=function(){var t=this.recoveryStorage.recover();if(null!==t){var e=t,i=e.metadata,n=e.events,r=new qe(this.sessionService,n,i);this.analysisEventsRecoveryRequest.setRequestParametersProviders(r),this.analysisEventsRecoveryRequest.send()}},t.prototype.addPageChangeListener=function(){window.addEventListener("pagehide",this.pageChangeHandler)},t.prototype.removePageChangeListener=function(){window.removeEventListener("pagehide",this.pageChangeHandler)},t}(),ze="csLegacyRecovered",He="CSStorageData";var Be=function(){function t(t,e,i,n,r,o,s,a){this.configuration=t,this.visitorService=e,this.sessionService=i,this.logger=n,this.pathComputation=r,this.eventPathComputation=o,this.selector=s,this.commands=a}return t.prototype.init=function(){!function(){localStorage.removeItem(ze);for(var t=[],e=0;e<localStorage.length;e+=1){var i=localStorage.key(e);0===i.indexOf(He)&&t.push(i)}t.forEach(function(t){return localStorage.removeItem(t)})}();var t=new qe(this.sessionService);this.analysisEventsService=this.createService(t),this.analysisEventsRecovery=this.createRecovery(t),this.analysisEventsService.init()},t.prototype.onStartTracking=function(){this.analysisEventsRecovery.start(),this.analysisEventsService.start()},t.prototype.onBeforeArtificialPageView=function(){this.analysisEventsService.clearStates()},t.prototype.onAfterNaturalPageView=function(){this.analysisEventsService.initStates()},t.prototype.onAfterArtificialPageView=function(){this.analysisEventsService.initStates()},t.prototype.onAfterSessionRenewal=function(){this.analysisEventsService.initStates()},t.prototype.onOptout=function(){this.analysisEventsService.stop(),this.analysisEventsRecovery.stop()},t.prototype.createService=function(t){var e=new be,i=new Oe(this.logger),r=new Ae(this.logger,this.sessionService,this.eventPathComputation,this.selector),o=new Re(new Ie(this.logger),this.pathComputation),s=new L(this.configuration.getTrackerUri(),"events"),a=new Qt(this.configuration,this.visitorService,this.sessionService,i,e,n);return new Le(r,o,i,e,t,s,a,mt)},t.prototype.createRecovery=function(t){var e=new L(this.configuration.getTrackerUri(),"events");return new Ue(this.sessionService,e,t,new $t("csAnalysisEventsPersisted",this.logger))},t}(),Fe={getWindowSize:function(){var t=document.documentElement,e=document.body,i=window;return{windowWidth:i.innerWidth?i.innerWidth:t&&t.clientWidth?t.clientWidth:e&&e.clientWidth?e.clientWidth:0,windowHeight:i.innerHeight?i.innerHeight:t&&t.clientHeight?t.clientHeight:e&&e.clientHeight?e.clientHeight:0}},getDocumentSize:function(){var t=document.body,e=window;return{documentWidth:t&&t.scrollWidth>t.offsetWidth?t.scrollWidth:t&&t.offsetWidth?t.offsetWidth:e.innerWidth&&e.scrollMaxX?e.innerWidth+e.scrollMaxX:0,documentHeight:t&&t.scrollHeight>t.offsetHeight?t.scrollHeight:t&&t.offsetHeight?t.offsetHeight:e.innerHeight&&e.scrollMaxY?e.innerHeight+e.scrollMaxY:0}},getDocumentEncoding:function(){return document.charset||document.characterSet||document.inputEncoding||document.defaultCharset||""},getPageReferrer:function(){return document.referrer||window.document.referrer||window.top.document.referrer||""},getPageTitle:function(){return document.title||window.document.title||""},getPageHtml:function(){var t=document.doctype||window.document.doctype,e="";return t&&(e="<!DOCTYPE "+t.name+(t.publicId?' PUBLIC "'+t.publicId+'"':"")+(!t.publicId&&t.systemId?" SYSTEM":"")+(t.systemId?' "'+t.systemId+'"':"")+">"),e+=document.documentElement.outerHTML||"<html>"+document.documentElement.innerHTML+"</html>"},windowPerformance:{get:function(){return window.performance||window.mozPerformance||window.msPerformance||window.webkitPerformance||{}},dnsLookupTime:function(){var t=this.get().timing;return t?t.domainLookupEnd-t.domainLookupStart:0},timeToStartLoading:function(){var t=this.get().timing;return t?t.responseStart-t.requestStart:0},pageDownloadTime:function(){var t=this.get().timing;return t?t.responseEnd-t.responseStart:0},contentLoadEventTime:function(){var t=this.get().timing;return t?t.domContentLoadedEventEnd-t.domContentLoadedEventStart:0},loadEventTime:function(){var t=this.get().timing;return t?t.loadEventEnd-t.loadEventStart:0},timeBeforeDomLoading:function(){var t=this.get().timing;return t?t.domLoading-t.navigationStart:0},timeBeforeDomInteractive:function(){var t=this.get().timing;return t?t.domInteractive-t.navigationStart:0},timeBeforeDomComplete:function(){var t=this.get().timing;return t?t.domComplete-t.navigationStart:0}}},je=function(){function t(t,e,i,n,r,o,s){this.sessionService=t,this.projectConfiguration=e,this.logger=i,this.compressor=n,this.consentService=r,this.htmlPageRequest=o,this.pii=s,this.htmlSent=!1,this.isPageViewAlreadyTracked=!1,this.stopSend=0,this.startSend=1}return t.prototype.send=function(){this.sendHtml(!1)},t.prototype.forceSend=function(){this.sendHtml(!0)},t.prototype.incrementStartSend=function(){this.startSend+=1},t.prototype.incrementStopSend=function(){this.stopSend+=1},t.prototype.setPageViewTracked=function(){this.isPageViewAlreadyTracked=!0},t.prototype.sendHtml=function(t){var e=this;if(this.isSendAllowed()&&(t||this.isPageViewAlreadyTracked&&!this.htmlSent&&this.startSend>this.stopSend)){mt.renewIfNeeded(),this.htmlSent=!0;var i=Fe.getPageHtml();i=this.stripSensitiveContent(i),i=this.stripUserInputData(i),i=this.pii.anonymize(i),this.compressor.compress(i,function(t){e.logger.tryToExecute("Send compressed HTML",function(){t&&e.htmlPageRequest.send(t)})()})}},t.prototype.isSendAllowed=function(){return this.sessionService.isAnalysisRecorded()&&this.projectConfiguration.collectHtml&&this.consentService.isAllowedByConsent()},t.prototype.stripSensitiveContent=function(t){for(var e=t.replace(/<!-- MousetestSensitiveStart ([\s\S]*?)-->([\s\S]*?)<!-- MousetestSensitiveEnd -->/g,"$1"),i=document.querySelectorAll("[data-cs-mask]"),n=0;n<i.length;n+=1){var r=i[n];e=e.replace(r.outerHTML,r.outerHTML.replace(r.innerHTML,""))}return e},t.prototype.stripUserInputData=function(t){var e=t.replace(/(<\s*input)([^>]*)(type\s*=\s*('|")\s*(?:email|file|hidden|number|password|search|tel|text)\s*\4)([^>]*)(value\s*=\s*'[^']*'|value\s*=\s*"[^"]*")/gim,"$1$2$3$5value=''");return e=(e=(e=e.replace(/(<\s*input)([^>]*)(value\s*=\s*'[^']*'|value\s*=\s*"[^"]*")([^>]*)(type\s*=\s*('|")\s*(?:email|file|hidden|number|password|search|tel|text)\s*\6)/gim,"$1$2value=''$4$5")).replace(/(<\s*input)((?:(?!type\s*=\s*)[^>])*)(?:value\s*=\s*'[^']*'|value\s*=\s*"[^"]*")((?:(?!type\s*=\s*).)*?>)/gim,"$1$2value=''$3")).replace(/(<\s*textarea)([^>]*)>([^<]*)/gim,"$1$2>")},t}(),We=function(){function t(t,e,i){this.domainUri=t,this.path=e,this.parametersGroup=i}return t.prototype.send=function(t){var e=this.parametersGroup.getRequestParameters();e.url=window.location.href,e.content=t;var i=I.toQuery(e);this.sendHtmlPageRequest(i)},t.prototype.sendHtmlPageRequest=function(t){var e=new XMLHttpRequest;e.open("POST",this.domainUri+"/"+this.path,!0),e.setRequestHeader("Access-Control-Expose-Headers","Content-compression"),e.setRequestHeader("Content-type","text/plain; charset=UTF-8"),e.setRequestHeader("Content-compression","LZString"),e.onreadystatechange=function(){},e.send(t)},t}(),Ge=function(){function t(t,e,i,n,r,o,s,a){this.visitorService=t,this.sessionService=e,this.configuration=i,this.logger=n,this.compressor=r,this.consentService=o,this.commands=s,this.pii=a}return t.prototype.init=function(){var t=this,e=new Qt(this.configuration,this.visitorService,this.sessionService,n),i=new We(this.configuration.getTrackerUri(),"page",e);this.htmlPage=new je(this.sessionService,this.configuration,this.logger,this.compressor,this.consentService,i,this.pii),this.commands.register("page:asyncSendHtml",function(){t.htmlPage.incrementStopSend()}),this.commands.register("page:sendHtml",function(){t.htmlPage.incrementStartSend(),t.htmlPage.send()})},t.prototype.onStartTracking=function(){this.htmlPage.send()},t.prototype.onAfterNaturalPageView=function(){this.htmlPage.setPageViewTracked()},t.prototype.onAfterArtificialPageView=function(){this.htmlPage.forceSend()},t.prototype.onAfterSessionRenewal=function(){this.htmlPage.forceSend()},t}(),Ze=function(){function t(t,e,i,n){this.lifeCycleEvents=t,this.sessionService=e,this.pageViewRequest=i,this.pii=n,this.isNaturalPageViewTriggered=!1,this.path=""}return t.prototype.triggerNaturalPageView=function(){this.isNaturalPageViewTriggered||this.sendNaturalPageView()},t.prototype.triggerArtificialPageView=function(t){this.overridePath(t),this.isNaturalPageViewTriggered?this.sendArtificialPageView():this.sendNaturalPageView()},t.prototype.sendNaturalPageView=function(){this.isNaturalPageViewTriggered=!0,this.lifeCycleEvents.emitBeforeNaturalPageView(),this.pageViewRequest.send(),this.lifeCycleEvents.emitAfterNaturalPageView()},t.prototype.sendArtificialPageView=function(){this.lifeCycleEvents.emitBeforeArtificialPageView(),this.pageViewRequest.send(),this.sessionService.isSessionRenewal()?this.lifeCycleEvents.emitAfterSessionRenewal():this.lifeCycleEvents.emitAfterArtificialPageView()},t.prototype.overridePath=function(t){Nt(t)&&(this.path=t)},t.prototype.getRequestParameters=function(){var e=t.computeUrl(this.path,window.location);return{url:this.pii.anonymize(e)}},t.computeUrl=function(t,e){if(""===t)return e.href;var i="/"===t.substring(0,1)?t:"/"+t;return e.protocol+"//"+e.host+i+e.search},t}(),Xe=window.navigator.language||window.navigator.userLanguage||window.navigator.browserLanguage||window.navigator.systemLanguage||"unknown";function Ke(){return{la:Xe}}var Ye=function(){function t(t,e){this.pii=t,this.cookieDomain=e}return t.prototype.getRequestParameters=function(){return{dr:this.get()}},t.prototype.get=function(){var t=this.consumeTestingTagRedirectionReferrer();return this.pii.anonymize(t||S.getReferrer())},t.prototype.consumeTestingTagRedirectionReferrer=function(){var t=k.get("uxt_referrer_source");return null!==t?(k.remove("uxt_referrer_source",this.cookieDomain),t):null},t}(),$e=function(){function t(t,e,i,n,r,o,s,a,c,u){this.configuration=t,this.commands=e,this.lifeCycleEvents=i,this.visitorService=n,this.sessionService=r,this.consentService=o,this.customVariablesService=s,this.testContextService=a,this.pii=c,this.cookieDomain=u}return t.prototype.init=function(){var t=this,e=new L(this.configuration.getTrackerUri(),"pageview");this.pageViewService=new Ze(this.lifeCycleEvents,this.sessionService,e,this.pii),e.setRequestParametersProviders(this.configuration,this.visitorService,this.sessionService,this.testContextService,Mt,new Ye(this.pii,this.cookieDomain),this.pageViewService,this.consentService,r,this.customVariablesService,n),this.commands.register("trackPageview",function(e){return t.pageViewService.triggerArtificialPageView(e)}),this.commands.register("setPath",function(e){return t.pageViewService.overridePath(e)})},t.prototype.start=function(){this.pageViewService.triggerNaturalPageView()},t}(),Je=function(){function t(t){this.pathComputation=t}return t.prototype.getTargetPath=function(t){var e=ke(t);return this.pathComputation.getElementPath(e)},t.prototype.hasValidTarget=function(t){var e=ke(t);return this.pathComputation.isValidElement(e)},t}(),Qe=function(){function t(t){this.pathComputation=t}return t.prototype.on=function(t,e){var i=this;return function(n){i.pathComputation.hasValidTarget(n)&&i.targetMatchesSelector(n,t)&&e(n)}},t.prototype.targetMatchesSelector=function(t,e){var i=ke(t);return this.getSelectorMatcher().call(i,e)},t.prototype.isMatchesSelectorSupported=function(){return!!this.getSelectorMatcher()},t.prototype.getSelectorMatcher=function(){return Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector},t}(),ti=function(){return(ti=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},ei=function(){function t(t,e,i){this.configuration=t,this.visitorService=e,this.sessionService=i}return t.prototype.getRequestParameters=function(){if(!this.visitorService.doesVisitorExist()||!this.sessionService.doesSessionExist())return{};var t=this.visitorService.getVisitor();return ti({},q(),this.configuration.getRequestParameters(),{uu:t.id,sn:""+t.visitsCount,pn:""+this.sessionService.getSession().pageNumber})},t}(),ii=function(){function t(t,e){this.pii=t,this.cookieDomain=e,this.customVariablesPage={}}return t.prototype.set=function(t,e,i,n){var r,o;if(t>0&&Lt(e)&&Lt(i)){var s=this.pii.anonymize(""+(Ot(e)?e:String(e))),a=this.pii.anonymize(""+(Ot(i)?i:String(i)));if(r=[s.slice(0,20),a.slice(0,255)],o=""!==i,!Nt(n)||"visit"===n||2===n){var c=this.getCustomVariablesSession();o?c[t]=r:delete c[t],U.set(c,this.cookieDomain)}Nt(n)&&"page"!==n&&3!==n||(o?this.customVariablesPage[t]=r:delete this.customVariablesPage[t])}},t.prototype.getRequestParameters=function(){var t=this.getCustomVariablesSession();for(var e in this.customVariablesPage)this.customVariablesPage.hasOwnProperty(e)&&(t[e]=this.customVariablesPage[e]);if(window.JSON.stringify(t).length<=2)return{};var i={cvars:this.getValidCustomVars(t),cvaru:this.getValidCustomVars(t)};return this.customVariablesPage&&window.JSON.stringify(this.customVariablesPage).length>2&&(i.cvarp=this.getValidCustomVars(this.customVariablesPage)),i},t.prototype.getCustomVariablesSession=function(){var t=U.get();return null!==t&&function(t){return"object"==typeof t}(t)?t:{}},t.prototype.getValidCustomVars=function(t){for(var e in t)if(t.hasOwnProperty(e)){var i=parseInt(e,10),n=t[e],r=n[0],o=n[1];(!Dt(i,1,20)||r.length>20||o.length>255)&&delete t[e]}var s=function(t){var e;for(e in t)return!1;return!0}(t)?[]:t;return window.JSON.stringify(s)},t}(),ni=function(){function t(t,e,i){this.commands=t,this.customVariablesService=e,this.cookieDomain=i}return t.prototype.init=function(){var t=this;this.commands.register("setCustomVariable",function(e,i,n,r){t.customVariablesService.set(e,i,n,r)})},t.prototype.onOptout=function(){U.remove(this.cookieDomain)},t}(),ri=function(){function t(){}return t.prototype.set=function(t){this.activeTests=t.tests,this.testingTagVersion=t.tagVersion},t.prototype.getRequestParameters=function(){return this.activeTests&&this.testingTagVersion?{uxt:function(t){return window.JSON.stringify(t.map(function(t){return[t.id,t.version]}))}(this.activeTests),uxtv:this.testingTagVersion}:{}},t}();var oi,si=function(){function t(t,e){this.commands=t,this.testContextService=e}return t.prototype.init=function(){var t=this;this.commands.register("setTestContext",function(e){return t.testContextService.set(e)})},t}(),ai=function(){function t(t){this.logger=t}return t.prototype.onLoad=function(t){this.onLoadCallback=t},t.prototype.start=function(){var t=this;this.onDocumentLoaded(function(){t.logger.tryToExecute("onLoad",function(){t.onLoadCallback()})()})},t.prototype.onDocumentLoaded=function(t){function e(){document.removeEventListener("DOMContentLoaded",e),window.removeEventListener("load",e),t()}"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?setTimeout(t):(document.addEventListener("DOMContentLoaded",e),window.addEventListener("load",e))},t}(),ci=function(){function t(t,e,i,n){this.visitorService=t,this.sessionService=e,this.commands=i,this.cookieDomain=n}return t.prototype.init=function(){var t=this;this.commands.register("clearSession",function(){return t.sessionService.removeSession(t.cookieDomain)})},t.prototype.onBeforeNaturalPageView=function(){this.visitorService.createOrUpdateVisitor(),this.sessionService.createOrUpdateSession()},t.prototype.onBeforeArtificialPageView=function(){this.visitorService.createOrUpdateVisitor(),this.sessionService.createOrUpdateSession()},t.prototype.onOptout=function(){this.visitorService.removeCurrentVisitor(),this.sessionService.removeCurrentSession()},t}(),ui=function(){function t(t,e,i,n,r,o,s,a,c,u,p,h){this.visitorService=t,this.sessionService=e,this.lifeCycleEvents=i,this.logger=n,this.commands=r,this.configuration=o,this.optoutModule=s,this.optoutService=a,this.consentModule=c,this.consentService=u,this.pii=p,this.cookieDomain=h}return t.prototype.start=function(){var t=this;mt.initTriesCount();var e=new Je(g),i=new Qe(e),n=new bt.a(function(e){t.logger.logMessage(e)}),r=new ei(this.configuration,this.visitorService,this.sessionService),o=new Be(this.configuration,this.visitorService,this.sessionService,this.logger,g,e,i,this.commands),s=new Ge(this.visitorService,this.sessionService,this.configuration,this.logger,n,this.consentService,this.commands,this.pii),a=new Se(this.commands,this.configuration,r,this.logger,n,this.pii),c=new le(this.visitorService,this.sessionService,this.commands),u=new Ce(this.configuration,this.visitorService,this.sessionService,this.commands,this.pii),p=new ii(this.pii,this.cookieDomain),h=new ni(this.commands,p,this.cookieDomain),l=new ri,d=new si(this.commands,l),f=new $e(this.configuration,this.commands,this.lifeCycleEvents,this.visitorService,this.sessionService,this.consentService,p,l,this.pii,this.cookieDomain),v=new ci(this.visitorService,this.sessionService,this.commands,this.cookieDomain),m=new ai(this.logger);if(this.consentModule.init(),c.init(),a.init(),u.init(),s.init(),h.init(),d.init(),f.init(),v.init(),this.lifeCycleEvents.addListeners(v,this.commands,o,this.consentModule,c,s,h),ce.isSupported()){var y=new ce(this.sessionService,this.configuration,this.logger,n,i,this.consentService,r,this.commands,this.pii);y.init(),this.lifeCycleEvents.addListeners(y)}o.init(),this.optoutModule.init(),this.optoutService.init(),this.optoutService.isActive()||(this.commands.startProcessing(),f.start(),m.onLoad(function(){t.lifeCycleEvents.emitStartTracking()}),m.start())},t}(),pi=function(){function t(t,e,i,n,r,o,s){this.configuration=t,this.visitorService=e,this.exclusionService=i,this.outdatedState=n,this.allowSubdomainsChange=r,this.crossDomainService=o,this.forceInclusionService=s}return t.prototype.compute=function(t){var e=this;this.configuration.crossDomainTracking?this.crossDomainService.applyUpToDate(function(){return e.computeState(t)}):this.computeState(t)},t.prototype.computeState=function(t){this.allowSubdomainsChange.handle(),this.outdatedState.clear(),this.isIncluded()?(this.outdatedState.restoreClearedVisitor(),t(!0)):(this.exclusionService.exclude(this.configuration.lastTrackingDraw),t(!1))},t.prototype.isIncluded=function(){var t=x(this.configuration.sampleRate);return this.forceInclusionService.isForceIncluded()||!this.exclusionService.isExcluded()&&this.visitorService.doesVisitorExist()||!this.exclusionService.isExcluded()&&t},t}();!function(t){t.generate=function(){var t=function(t){for(var e=0,i=0;i<t.length;i+=1)e=t.charCodeAt(i)+(e<<6)+(e<<16)-e;return Math.abs(e)}(navigator.userAgent+navigator.language+navigator.platform).toString(16).slice(-4),e=(new Date).getTime();return"xxxxxxxx-hhhh-axxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:7&i|8).toString(16)}).replace("hhhh",t)}}(oi||(oi={}));var hi=function(){function t(t,e,i){this.configuration=t,this.sessionService=e,this.cookieDomain=i}return t.prototype.createOrUpdateVisitor=function(){var t=this.getVisitor();null===t&&(t=this.createVisitor(),this.sessionService.removeCurrentSession()),this.updateVisitor(t),this.setVisitor(t)},t.prototype.createVisitor=function(){return{id:oi.generate(),visitsCount:0,appliedTrackingDraw:this.configuration.lastTrackingDraw,creationTimestamp:E(),lastVisitTimestamp:0,hitTimestamp:0,expires:Date.now()+this.configuration.visitorCookieTimeout}},t.prototype.updateVisitor=function(t){var e=E();this.sessionService.doesSessionExist()||(t.visitsCount+=1,t.lastVisitTimestamp=e),t.hitTimestamp=e,t.appliedTrackingDraw=this.configuration.lastTrackingDraw},t.prototype.getRequestParameters=function(){if(this.doesVisitorExist()){var t=this.getVisitor();return{uu:t.id,sn:""+t.visitsCount,lv:""+t.lastVisitTimestamp,lhd:""+t.lastVisitTimestamp,hd:""+t.hitTimestamp}}return{}},t.prototype.getVisitor=function(){return G.get()},t.prototype.setVisitor=function(t){G.set(t,this.cookieDomain)},t.prototype.doesVisitorExist=function(){return null!==G.get()},t.prototype.removeCurrentVisitor=function(){this.removeVisitor(this.cookieDomain)},t.prototype.removeVisitor=function(t){G.remove(t)},t}(),li=function(){function t(t,e,i,n,r){this.configuration=t,this.sessionStorage=e,this.logger=i,this.forceInclusionService=n,this.cookieDomain=r}return t.prototype.createOrUpdateSession=function(){var t=this.getSessionWithoutCache();null===t&&(t=this.createSession()),this.updateSession(t),this.setSession(t)},t.prototype.createSession=function(){return{pageNumber:0,recordingState:this.computeRecordingState()}},t.prototype.computeRecordingState=function(){return this.isCompressionSupported()?this.forceInclusionService.isForceNotRecorded()?"0":this.forceInclusionService.isForceAnalysisRecorded()?"1":this.forceInclusionService.isForceReplayRecorded()?"2":this.computeRecordingType(this.configuration.replayRecordingRate,this.configuration.analysisRecordingRate):"0"},t.prototype.isCompressionSupported=function(){return new bt.a(_).isSupported()},t.prototype.computeRecordingType=function(t,e){var i=t+e;if(i>100)return this.reportMaxRecordingRatesExceeded(t,e),"0";var n=S.getRandomPercentage();return n<t?ce.isSupported()?"2":"0":n<i?"1":"0"},t.prototype.reportMaxRecordingRatesExceeded=function(t,e){var i="Sum of recording rates exceeds 100.\n      Replay recording rate: "+t+" \n      Analysis recording rate: "+e;this.logger.logError(i)},t.prototype.updateSession=function(t){t.pageNumber+=1},t.prototype.isSessionRenewal=function(){return 1===this.getSession().pageNumber},t.prototype.isAnalysisRecorded=function(){return this.doesSessionExist()&&"1"===this.getSession().recordingState},t.prototype.isReplayRecorded=function(){return this.doesSessionExist()&&"2"===this.getSession().recordingState},t.prototype.removeCurrentSession=function(){this.removeSession(this.cookieDomain)},t.prototype.getRequestParameters=function(){if(this.doesSessionExist()){var t=this.getSession();return{pn:""+t.pageNumber,re:t.recordingState}}return{}},t.prototype.getSession=function(){return this.sessionStorage.get()},t.prototype.getSessionWithoutCache=function(){return this.sessionStorage.get(!0)},t.prototype.doesSessionExist=function(){return null!==this.sessionStorage.get()},t.prototype.setSession=function(t){this.sessionStorage.set(t)},t.prototype.removeSession=function(t){this.sessionStorage.remove(t)},t}(),di=function(){function t(t,e,i,n){this.configuration=t,this.visitorService=e,this.exclusionService=i,this.cookieDomain=n}return t.prototype.clear=function(){this.isVisitorOutdated()&&(this.savedVisitor=this.visitorService.getVisitor(),this.visitorService.removeVisitor(this.cookieDomain)),this.isExclusionOutdated()&&this.exclusionService.removeExclusion()},t.prototype.isVisitorOutdated=function(){return this.visitorService.doesVisitorExist()&&this.visitorService.getVisitor().appliedTrackingDraw!==this.configuration.lastTrackingDraw},t.prototype.isExclusionOutdated=function(){return this.exclusionService.getAppliedTrackingDraw()!==this.configuration.lastTrackingDraw},t.prototype.restoreClearedVisitor=function(){this.savedVisitor&&this.visitorService.setVisitor(this.savedVisitor)},t}(),fi=function(){function t(t,e,i){this.configuration=t,this.visitorService=e,this.sessionService=i}return t.prototype.handle=function(){this.handleVisitor(),this.handleSession()},t.prototype.handleVisitor=function(){var t=this.visitorService.getVisitor();t&&(this.configuration.allowSubdomains?this.visitorService.removeVisitor(k.CURRENT_DOMAIN):this.visitorService.removeVisitor(k.getRootDomain()),this.visitorService.setVisitor(t))},t.prototype.handleSession=function(){var t=this.sessionService.getSessionWithoutCache();t&&(this.configuration.allowSubdomains?this.sessionService.removeSession(k.CURRENT_DOMAIN):this.sessionService.removeSession(k.getRootDomain()),this.sessionService.setSession(t))},t}();var gi,vi=function(){function t(t){this.logger=t,this.registry={}}return t.prototype.register=function(t,e){this.registry[t]=e,this.registry},t.prototype.startProcessing=function(){this.applyPending(),this.enableImmediateApplication()},t.prototype.onOptout=function(){window._uxa=[]},t.prototype.applyPending=function(){var t=this;window._uxa.forEach(function(e){var i=e[0],n=e.slice(1);return t.apply(i,n)})},t.prototype.enableImmediateApplication=function(){var t=this;window._uxa={push:function(e){var i=e[0],n=e.slice(1);return t.apply(i,n)}}},t.prototype.apply=function(t,e){var i=this;return this.logger.tryToExecute("Commands.apply",function(){var n;if(i.registry[t])return(n=i.registry)[t].apply(n,e)})()},t}(),mi=function(){function t(){this.listeners=[]}return t.prototype.addListeners=function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];(t=this.listeners).push.apply(t,e)},t.prototype.emitBeforeNaturalPageView=function(){for(var t=0,e=this.listeners;t<e.length;t++){var i=e[t];i.onBeforeNaturalPageView&&i.onBeforeNaturalPageView()}},t.prototype.emitAfterNaturalPageView=function(){for(var t=0,e=this.listeners;t<e.length;t++){var i=e[t];i.onAfterNaturalPageView&&i.onAfterNaturalPageView()}},t.prototype.emitStartTracking=function(){for(var t=0,e=this.listeners;t<e.length;t++){var i=e[t];i.onStartTracking&&i.onStartTracking()}},t.prototype.emitBeforeArtificialPageView=function(){for(var t=0,e=this.listeners;t<e.length;t++){var i=e[t];i.onBeforeArtificialPageView&&i.onBeforeArtificialPageView()}},t.prototype.emitAfterArtificialPageView=function(){for(var t=0,e=this.listeners;t<e.length;t++){var i=e[t];i.onAfterArtificialPageView&&i.onAfterArtificialPageView()}},t.prototype.emitAfterSessionRenewal=function(){for(var t=0,e=this.listeners;t<e.length;t++){var i=e[t];i.onAfterSessionRenewal&&i.onAfterSessionRenewal()}},t.prototype.emitOptout=function(){for(var t=0,e=this.listeners;t<e.length;t++){var i=e[t];i.onOptout&&i.onOptout()}},t.prototype.emitConsentGranted=function(){for(var t=0,e=this.listeners;t<e.length;t++){var i=e[t];i.onConsentGranted&&i.onConsentGranted()}},t.prototype.emitConsentWithdrawn=function(){for(var t=0,e=this.listeners;t<e.length;t++){var i=e[t];i.onConsentWithdrawn&&i.onConsentWithdrawn()}},t}();!function(t){t[t.NOT_REQUIRED=0]="NOT_REQUIRED",t[t.NOT_EXPRESSED=1]="NOT_EXPRESSED",t[t.GRANTED=2]="GRANTED",t[t.WITHDRAWN=3]="WITHDRAWN"}(gi||(gi={}));var yi,Si=function(){function t(t){this.cookieDomain=t}return t.prototype.get=function(){var t=k.get("_cs_c");return null===t?t:Number(t)},t.prototype.set=function(t){k.set("_cs_c",t,this.cookieDomain,C)},t.prototype.remove=function(t){k.remove("_cs_c",t)},t}(),wi=function(){function t(t,e){this.commands=t,this.service=e}return t.prototype.init=function(){this.service.handleSubdomainChange(),this.service.setInitialConsent(),this.registerCommands()},t.prototype.registerCommands=function(){var t=this;this.commands.register("trackConsentGranted",function(){t.service.grantConsent()}),this.commands.register("trackConsentWithdrawn",function(){t.service.withdrawConsent()})},t.prototype.onOptout=function(){this.service.removeCurrentConsent()},t}(),Ei=function(){function t(t,e,i,n){this.configuration=t,this.storage=e,this.lifeCycleEvents=i,this.cookieDomain=n}return t.prototype.setInitialConsent=function(){var t=this.storage.get();(null===t||this.hasConsentRequiredChanged(t))&&this.setDefault()},t.prototype.hasConsentRequiredChanged=function(t){var e=this.configuration.consentRequired;return e&&t===gi.NOT_REQUIRED||!e&&t!==gi.NOT_REQUIRED},t.prototype.handleSubdomainChange=function(){this.configuration.allowSubdomains?this.storage.remove(k.CURRENT_DOMAIN):this.storage.remove(k.getRootDomain())},t.prototype.setDefault=function(){var t=this.configuration.consentRequired?gi.NOT_EXPRESSED:gi.NOT_REQUIRED;this.storage.set(t)},t.prototype.grantConsent=function(){this.configuration.consentRequired&&(this.storage.set(gi.GRANTED),this.lifeCycleEvents.emitConsentGranted())},t.prototype.withdrawConsent=function(){this.configuration.consentRequired&&(this.storage.set(gi.WITHDRAWN),this.lifeCycleEvents.emitConsentWithdrawn())},t.prototype.removeCurrentConsent=function(){this.storage.remove(this.cookieDomain)},t.prototype.isAllowedByConsent=function(){return!this.configuration.consentRequired||this.storage.get()===gi.GRANTED},t.prototype.getRequestParameters=function(){return{uc:""+this.storage.get()}},t}(),_i=function(){function t(t,e,i,n,r,o){this.lifeCycleEvents=t,this.commands=e,this.optoutModule=i,this.optoutService=n,this.exclusionModule=r,this.consentModule=o}return t.prototype.start=function(){this.lifeCycleEvents.addListeners(this.exclusionModule,this.consentModule,this.commands),this.consentModule.init(),this.optoutModule.init(),this.optoutService.init(),this.optoutService.isActive()||this.commands.startProcessing()},t}(),Ci=function(){function t(t){this.service=t}return t.prototype.onOptout=function(){this.service.removeExclusion()},t}(),xi=function(){function t(t){this.location=t}return t.prototype.isForceIncluded=function(){return this.hasForceInclusionCookie()||this.hasForceInclusionInURL()},t.prototype.isForceNotRecorded=function(){return this.hasForceInclusionCookieValue("0")||this.hasForceInclusionValueInURL("0")},t.prototype.isForceAnalysisRecorded=function(){return this.hasForceInclusionCookieValue("1")||this.hasForceInclusionValueInURL("1")},t.prototype.isForceReplayRecorded=function(){return this.hasForceInclusionCookieValue("2")||this.hasForceInclusionValueInURL("2")},t.prototype.hasForceInclusionCookie=function(){return null!==k.get("_cs_inc")},t.prototype.hasForceInclusionCookieValue=function(t){return k.get("_cs_inc")===t},t.prototype.hasForceInclusionInURL=function(){return this.location.href.indexOf("_cs_inc")>0},t.prototype.hasForceInclusionValueInURL=function(t){return this.location.href.indexOf("_cs_inc="+t)>0},t}(),bi=function(){return(bi=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Ri=function(){function t(){this.metrics={}}return t.prototype.start=function(t,e){void 0===e&&(e=Date.now());var i=this.metrics[t];this.metrics[t]=bi({startedAt:e},i)},t.prototype.stop=function(t,e){void 0===e&&(e=Date.now());var i=this.metrics[t];this.metrics[t]=bi({stoppedAt:e},i),this.onStopCallback(t,this.metrics[t])},t.prototype.onStop=function(t){this.onStopCallback=t},t}(),Ti=function(){function t(){}return t.prototype.getRequestParameters=function(){var t=window.location;return{pr:t.protocol,ho:t.hostname,pa:t.pathname,qu:t.search,ha:t.hash}},t}(),ki=function(){function t(t,e){this.configuration=t,this.request=e,this.isLoggingActive=!1}return t.prototype.init=function(){this.isLoggingActive=x(this.configuration.metricRate)},t.prototype.getRequestParameters=function(){return{a:"uxam",mk:this.metricKey,mv:""+this.metricValue}},t.prototype.logMetric=function(t,e){this.metricKey=t,this.metricValue=e.stoppedAt-e.startedAt,this.sendLog()},t.prototype.sendLog=function(){this.isLoggingActive&&this.request.send()},t}();!function(t){t.TIME_BEFORE_EXECUTION="TimeBeforeExecution",t.PAGE_LOAD="PageLoad"}(yi||(yi={}));var Pi,Ii=function(){function t(t,e,i){this.service=e,this.pii=i,this.locationRequestParameters=new Ti,this.basicLogRequestParameters=new H(t,this.pii),this.request=new L(t.getErrorUri()),this.logger=new ki(t,this.request)}return t.prototype.init=function(){var t=this;this.request.setRequestParametersProviders(this.logger,this.basicLogRequestParameters,this.locationRequestParameters),this.logger.init(),this.service.onStop(function(e,i){t.logger.logMetric(e,i)}),this.recordInitialMetrics()},t.prototype.recordInitialMetrics=function(){this.isSupported()&&(this.service.start(yi.PAGE_LOAD,window.performance.timing.navigationStart),this.service.stop(yi.PAGE_LOAD,window.performance.timing.domContentLoadedEventEnd),this.service.start(yi.TIME_BEFORE_EXECUTION,window.performance.timing.domContentLoadedEventEnd),this.service.stop(yi.TIME_BEFORE_EXECUTION))},t.prototype.isSupported=function(){return window.performance&&window.performance.timing},t}(),Ai=function(){function t(t,e,i){this.lifeCycleEvents=t,this.location=e,this.cookieDomain=i}return t.prototype.init=function(){!this.isActive()&&this.hasOptoutInURL()&&this.activate()},t.prototype.isActive=function(){return"1"===k.get("_cs_optout")},t.prototype.activate=function(){this.lifeCycleEvents.emitOptout(),k.set("_cs_optout","1",this.cookieDomain,315576e6)},t.prototype.hasOptoutInURL=function(){return this.location.href.indexOf("_cs_optout")>0},t}(),Oi=function(){function t(t,e){this.commands=t,this.optoutService=e}return t.prototype.init=function(){var t=this;this.commands.register("optout",function(){t.optoutService.activate()})},t}();function Ni(t,e){return e.visitor.visitsCount!==t.visitor.visitsCount?e.visitor.visitsCount-t.visitor.visitsCount:t.session?e.session?e.session.pageNumber-t.session.pageNumber:-1:1}!function(t){t.select=function(t,e){var i=function(t,e){return t.filter(function(t){return t.exclusion===e})[0]}(t,e),n=function(t,e){return t.filter(function(t){return function(t,e){return t.visitor&&t.visitor.appliedTrackingDraw===e}(t,e)}).sort(Ni)[0]}(t,e);return i||n}}(Pi||(Pi={}));var Li=function(){function t(t,e,i){this.configuration=t,this.currentDomainState=e,this.otherDomainStates=i}return t.prototype.applyUpToDate=function(t){var e=this;this.otherDomainStates.retrieve(this.configuration.hostnames,function(i){var n=[e.currentDomainState.get()].concat(i),r=Pi.select(n,e.configuration.lastTrackingDraw);e.currentDomainState.apply(r),t()})},t}(),Di=function(){function t(t,e,i){this.configuration=t,this.logger=e,this.pii=i}return t.prototype.init=function(){var t=this,e=new Ri,i=new Ii(this.configuration,e,this.pii),n=new xi(window.location),r=k.getCookieDomain(this.configuration.allowSubdomains),o=new et(r),s=new li(this.configuration,o,this.logger,n,r),a=new hi(this.configuration,s,r);this.logger.setContext(a,s);var c=new fi(this.configuration,a,s),u=new rt(window.location,r),p=new Ci(u),h=new di(this.configuration,a,u,r),l=new X(a,s,u,this.configuration,r),d=new st(this.logger),f=new ot(d,this.logger,window.location),g=new Li(this.configuration,l,f),v=new pi(this.configuration,a,u,h,c,g,n);return i.init(),v.compute(function(e){var i=new vi(t.logger),n=new mi,o=new Si(r),c=new Ei(t.configuration,o,n,r),u=new wi(i,c),h=new Ai(n,window.location,r),l=new Oi(i,h);e?new ui(a,s,n,t.logger,i,t.configuration,l,h,u,c,t.pii,r).start():new _i(n,i,l,h,p,u).start()}),{LZString:De.a}},t}();try{w.preventConflict(window.CS_CONF);var Mi=new R(window.CS_CONF);window._uxa=window._uxa||[],Mi.processOptionOverrides(window._uxa);var Vi=new j,qi=new B(Mi,Vi).create();qi.tryToExecute("index.start",function(){var t=new A(Mi);if(!window.UXAnalytics&&t.canTrack()){var e=new Di(Mi,qi,Vi);window.UXAnalytics=e.init()}!window.CSFrameCommunication&&T.isActivable()&&(window.CSFrameCommunication=T,T.waitForConnection())})()}catch(t){}}]);